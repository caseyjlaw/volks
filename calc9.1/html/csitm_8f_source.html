<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CALC: csitm.f Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CALC
   &#160;<span id="projectnumber">9.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">csitm.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="csitm_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="csitm_8f.html#a9601fba281579c0631d439803ca96317">sita</a></div><div class="line"><a name="l00002"></a><span class="lineno"><a class="line" href="csitm_8f.html#a9601fba281579c0631d439803ca96317">    2</a></span>&#160;      <span class="keywordtype">IMPLICIT None</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">C 1.    SITA</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">C 1.1   SITA PROGRAM SPECIFICATION</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">C 1.1.1 SITA ADDs entries to the Table of Contents for the</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">C       Site Module text message and the partial derivatives array.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">C 1.2   SITA PROGRAM INTERFACE</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">C 1.2.1 CALLING SEQUENCE - NONE</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">C 1.2.2 COMMON BLOCKS USED - </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      include <span class="stringliteral">&#39;inputs.i&#39;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">C            Variables from:</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">C              1. Input_sites - T/F logical flag telling whether to use</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">C                               external site a priori input.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      include <span class="stringliteral">&#39;cmxst.i&#39;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">C            Variables from:</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">C              1. NUMSIT   - Number of sites in the data base.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">C              2. Max_Stat - Maximun number of stations allowed.</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      include <span class="stringliteral">&#39;cuser.i&#39;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">C       Variables from:</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">C         1. Calc_user  - Calc user type. &#39;A&#39; for Mark III/SOLVE analysis.</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">C                         &#39;C&#39; for VLBI correlator.</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">C 1.2.3 PROGRAM SPECIFICATIONS - NONE </span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">C </span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">C 1.2.4 DATA BASE ACCESS -</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">C            ACCESS CODES ADDED:</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">C              1.  &#39;SIT MESS&#39;  -  THE DATA BASE ACCESS CODE FOR THE </span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">C                                 SITE MODULE TEXT MESSAGE. </span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">C              2.  &#39;SIT PART&#39;  -  THE DATA BASE ACCESS CODE FOR THE SITE</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">C                                 MODULE TEXT MESSAGE.</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">C </span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">C 1.2.5 EXTERNAL INPUT/OUTPUT -  None</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">C </span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">C 1.2.6 SUBROUTINE INTERFACE -</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">C           CALLER SUBROUTINES: TOCUP </span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">C           CALLED SUBROUTINES: ADDA, ADDR, ADDI</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">C 1.2.7 CONSTANTS USED - NONE</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">C 1.2.8 PROGRAM VARIABLES - NONE</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">C 1.2.9 PROGRAMMER - DALE MARKHAM  01/13/77</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">C                    PETER DENATALE 07/13/77</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">C                    SAVITA GOEL    06/03/87 (CDS FOR A900)</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">C                    89.07.20 Jim Ryan Documentation simplified.</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">C                    Jim Ryan 89.12.12 UNIX-like database interface</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">C                        implimented.</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">C                    David Gordon 94.04.16 Converted to Implicit None.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">C                    David Gordon 94.06.08 Corrected format statements all</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">C                         subroutines, where single and double quotes reversed.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">C                    David Gordon 98.03.17 Mods and ADD&#39;s for source a priori&#39;s</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">C                         and ocean loading in the case of external site inputs</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">C                    David Gordon 98.11.05 Mods/ADD for &#39;SITEXYZS&#39;, velocity</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">C                         corrected site coordinates. For correlator use only.</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">C     SITA Program Structure</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">C     ADD for module text message.</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a06e06b83a933855a258c22bdff0d38dc">adda</a> (1,<span class="stringliteral">&#39;SIT MESS&#39;</span>,<span class="stringliteral">&#39;Site Module Message Definition  &#39;</span>,</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;     1     40, 1, 1 )</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">C     ADD for Site module partials.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a5696959340499139130b420c4ac78373">addr</a> (2,<span class="stringliteral">&#39;SIT PART&#39;</span>,<span class="stringliteral">&#39;Site partial derivative def.    &#39;</span>,</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;     1     3, 2, 2 )</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">C   Do adds to replace the site a priori&#39;s in the data base in the case of </span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">C    external file inputs</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">If</span> (input_sites) <span class="keywordflow">Then</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        print *, <span class="stringliteral">&#39;ADDs for external site catalog&#39;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a5696959340499139130b420c4ac78373">addr</a>(1,<span class="stringliteral">&#39;SITERECS&#39;</span>,<span class="stringliteral">&#39;Site cartesian coords (m).      &#39;</span>,</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;     *          3,numsit,1)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a5696959340499139130b420c4ac78373">addr</a>(1,<span class="stringliteral">&#39;SITEZENS&#39;</span>,<span class="stringliteral">&#39;Site zenith path delays (nsec). &#39;</span>,</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;     *          numsit,1,1)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#ae6231d12a4386a2dd80ae35f21fdde1a">addi</a>(1,<span class="stringliteral">&#39;AXISTYPS&#39;</span>,<span class="stringliteral">&#39;Axis type (1-eq,2-xy,3-azel,4,5)&#39;</span>,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;     *          numsit,1,1)</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a5696959340499139130b420c4ac78373">addr</a>(1,<span class="stringliteral">&#39;AXISOFFS&#39;</span>,<span class="stringliteral">&#39;Axis offsets (m).               &#39;</span>,</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;     *          numsit,1,1)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keywordflow">      Endif</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">C   Do adds to replace the ocean loading coefficients in the data base in </span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">C    the case of external file inputs</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">If</span> (input_ocean) <span class="keywordflow">Then</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        print *, <span class="stringliteral">&#39;ADDs for external ocean loading catalog&#39;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a5696959340499139130b420c4ac78373">addr</a>(1,<span class="stringliteral">&#39;SITOCAMP&#39;</span>,<span class="stringliteral">&#39;Vert ocean loading ampltudes (m)&#39;</span>,</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;     *          11,numsit,1)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a5696959340499139130b420c4ac78373">addr</a>(1,<span class="stringliteral">&#39;SITOCPHS&#39;</span>,<span class="stringliteral">&#39;Vert ocean loading phases (rad).&#39;</span>,</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;     *          11,numsit,1)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a5696959340499139130b420c4ac78373">addr</a>(1,<span class="stringliteral">&#39;SITHOCAM&#39;</span>,<span class="stringliteral">&#39;Horz ocean loading ampltudes (m)&#39;</span>,</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;     *          11,2,numsit)</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a5696959340499139130b420c4ac78373">addr</a>(1,<span class="stringliteral">&#39;SITHOCPH&#39;</span>,<span class="stringliteral">&#39;Horz ocean loading phases (rad).&#39;</span>,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;     *          11,2,numsit)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordflow">      Endif</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">C Do add for modified/unmodified site positions for correlator usage. </span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">C  Correlator users must capture this access code for downstream analysis</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">C  (in AIPS, HOPS, etc.) (in place of &#39;SITERECS&#39;) if they use the &#39;SITERECV&#39;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">C  access code for site input. The number of stations will probably not be</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">C  known at this time. To avoid unnecessary complications, we allow for the</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">C  maximum number of stations, as defined in &#39;cmxst.i&#39;.</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;       <span class="keywordflow">If</span> (calc_user. eq. <span class="stringliteral">&#39;C&#39;</span>) <span class="keywordflow">Then</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a5696959340499139130b420c4ac78373">addr</a>(1,<span class="stringliteral">&#39;SITEXYZS&#39;</span>,<span class="stringliteral">&#39;Site Coords To Date (meters)    &#39;</span>,</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;     *          3, max_stat, 1)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordflow">       Endif</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">C     Normal conclusion.</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">C******************************************************************************</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="csitm_8f.html#aa9d490db42c8398a747838ceed61e6d4">siti</a></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="csitm_8f.html#aa9d490db42c8398a747838ceed61e6d4">  118</a></span>&#160;      <span class="keywordtype">IMPLICIT None</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">C 3.    SITI</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">C 3.1   SITI PROGRAM SPECIFICATION</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">C 3.1.1 SITI is the Site Module input and initialization section.</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">C 3.1.2 RESTRICTIONS - NONE</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">C 3.1.3 REFERENCES - SMART, W.M., &#39;TEXTBOOK ON SPHERICAL ASTRONOMY&#39;,</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">C                    1965, P. 195-198</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">C                    MARKHAM&#39;S X-DOCUMENT</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">C 3.2   SITI PROGRAM INTERFACE</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">C 3.2.1 CALLING SEQUENCE - NONE</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">C 3.2.2 COMMON BLOCKS USED -</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      include <span class="stringliteral">&#39;cphys.i&#39;</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">C            VARIABLES &#39;FROM&#39;:</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">C              1. EFLAT  -  THE FLATTENNING OF THE ELLIPSOID APPROXIMATING</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">C                           THE SHAPE OF THE EARTH.  (UNITLESS)</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">C              2. REARTH -  THE EQUATORIAL RADIUS OF THE EARTH. (M)</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">Real*8</span>           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keyword">COMMON</span> / cmath / pi, twopi, halfpi, convd, convds, convhs, secday</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">ExTERNAL</span> cmathb</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      include <span class="stringliteral">&#39;cmxst.i&#39;</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      include <span class="stringliteral">&#39;ccon.i&#39;</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">C            VARIABLES &#39;FROM&#39;:</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">C              1. KSITC  -  THE SITE MODULE FLOW CONTROL FLAG.</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">C              2. KSITD  -  THE SITE MODULE DEBUG OUTPUT FLAG.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      include <span class="stringliteral">&#39;inputs.i&#39;</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">C            Variables from:</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">C              1. Input_sites - T/F logical flag telling whether to use</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">C                               external site a priori input</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">C              2. Input_ocean - T/F logical flag telling whether to</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">C                               use external ocean loading a priori input</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">C              3. Ex_sites    - File name for sites external file input.</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">C                               If &#39;NONE&#39; or blank, external site input</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">C                               will not be done.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">C              4. Ex_ocean    - File name for ocean loading external file.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">C                               If &#39;NONE&#39; or blank, external ocean loading </span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">C                               input will not be done.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      include <span class="stringliteral">&#39;cuser.i&#39;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">C       Variables from:</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">C         1. Calc_user  - Calc user type. &#39;A&#39; for Mark III/SOLVE analysis.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">C                         &#39;C&#39; for VLBI correlator.</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">C 3.2.3 PROGRAM SPECIFICATIONS -</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordtype">Integer*2</span> KERR(10), LSITM(40), NDO(3), NDI(3), NN, numsit_local,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;     *          intrvl(5,2), kerx(2)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordtype">Integer*4</span> N, I, J, K, L, ik, kj, imdoy(12), Intmov</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordtype">REAL*8</span> XLAT_DUMMY,XLON_DUMMY, RY(3,3), RZ(3,3), TCROT_DUMMY(3,3),</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;     *       rgy(3,3), glat_dummy, rtrot_dummy(3,3), sitxyzv(7,max_stat)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordtype">Real*8</span> xlatlonht(3),pie,a,fl,xyz(3), Xdoy1, Xepoch, X_frac</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordtype">CHARACTER*40</span> C_LSITM(2)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      equivalence(lsitm,c_lsitm)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordtype">CHARACTER*1</span> ITEST, idum(3)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">C     Logical*4 Input_sites, Input_ocean </span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keyword">DATA</span> c_lsitm /</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;     .<span class="stringliteral">&#39;SITE MODULE - Last modified 98.10.26, D.&#39;</span>,</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;     .<span class="stringliteral">&#39; Gordon, GSFC                           &#39;</span>/</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keyword">Data</span> imdoy /0,31,59,90,120,151,181,212,243,273,304,334/</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">C 3.2.4 DATA BASE ACCESS -</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">C    &#39;GET&#39; VARIABLES:</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">C      1. KTYPE(Max_Stat)       -  THE ANTENNA AXIS TYPES.  (UNITLESS)</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">C      2. LNSITE(4,Max_Stat)    -  THE EIGHT ALPHAMERIC CHARACTER SITE NAMES</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">C                                  OF THE SITES IN THE SITE CATALOG.</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">C      3. NUMSIT                -  THE NUMBER OF SITES IN THE SITE CATALOG.</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">C      4. SITAXO(Max_Stat)      -  THE SITE ANTENNA AXIS OFFSETS. (M)</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">C      5. SITOAM(11,Max_Stat)   -  THE SITE VERTICAL OCEAN LOADING</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">C                                  AMPLITUDES. (M)</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">C      6. SITOPH(11,Max_Stat)   -  THE SITE VERTICAL OCEAN LOADING PHASES.</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">C                                  (RAD)</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">C      7. SITHOA(11,2,Max_Stat) -  THE SITE HORIZONTAL OCEAN LOADING</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">C                                  AMPLITUDES. (M)</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">C      8. SITHOP(11,2,Max_Stat) -  THE SITE HORIZONTAL OCEAN LOADING PHASES.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">C                                  (RAD)</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">C      9. SITXYZ(3,Max_Stat)    -  THE SITE CRUST FIXED X, Y, &amp; Z</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">C                                  COORDINATES. (M, M, M )</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">C     10. SITZEN(Max_Stat)      -  THE ZENITH ELECTRICAL PATH LENGTH</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">C                                  AT EACH OBSERVATION SITE. (SEC)</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">C     11. Sitxyzv(7,Max_Stat)   -  Optional correlator input via access code</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">C                                  &#39;SITERECV&#39; in place of SITXYZ (via </span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">C                                  &#39;SITERECS&#39;). First index runs over site crust</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">C                                  fixed coordinates (X, Y, Z), epoch for</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">C                                  those coordinates (4-digit and fractional</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">C                                  year, such as 1998.5), and site velocities</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">C                                  (X-velocity, Y-velocity, Z-velocity). </span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">C                                  Second index runs over the sites. For</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">C                                  geocenter station make sure X-velocity =</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">C                                  Y-velocity = Z-velocity = 0.D0.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">C                                  (m, m, m, yrs, m/sec, m/sec, m/sec) </span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">C    &#39;PUT&#39; VARIABLES:</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">C      1. LSITM(40)  -  THE SITE MODULE TEXT MESSAGE.</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">C      2. SITXYZ(3,Max_Stat) - Correlator output of site crust fixed </span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">C                       coordinates, modified if access code &#39;SITERECV&#39; </span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">C                       supplied. </span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">C    ACCESS CODES:</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">C      1. &#39;SIT MESS&#39;  -  THE DATA BASE ACCESS CODE FOR THE SITE MODULE TEXT</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">C                        MESSAGE.</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">C      2. &#39;AXISTYPS&#39;  -  THE DATA BASE ACCESS CODE FOR THE ARRAY OF SITE </span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">C                        ANTENNA TYPES.</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">C      3. &#39;SITNAMES&#39;  -  THE DATA BASE ACCESS CODE FOR THE ARRAY OF SITE NAMES.</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">C      4. &#39;# SITES &#39;  -  THE DATA BASE ACCESS CODE FOR THE NUMBER OF </span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">C                        OBSERVATION SITES.</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">C      5. &#39;AXISOFFS&#39;  -  THE DATA BASE ACCESS CODE FOR THE ARRAY OF SITE</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">C                        ANTENNA AXIS OFFSETS. </span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">C      6. &#39;SITERECS&#39;  -  THE DATA BASE ACCESS CODE FOR THE  ARRAY OF SITE</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">C                        X,Y,Z COORDINATES.</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">C      7. &#39;SITEZENS&#39;  -  THE DATA BASE ACCESS CODE FOR THE SITE ZENITH </span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">C                        ELECTRICAL PATH LENGTH. </span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">C      8. &#39;SITOCAMP&#39;  -  THE DATA BASE ACCESS CODE FOR THE VERTICAL OCEAN</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">C                        LOADING AMPLITUDES.</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">C      9. &#39;SITOCPHS&#39;  -  THE DATA BASE ACCESS CODE FOR THE VERTICAL OCEAN</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">C                        LOADING PHASES.</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">C     10. &#39;SITHOCAM&#39;  -  THE DATA BASE ACCESS CODE FOR THE HORIZONTAL OCEAN</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">C                        LOADING AMPLITUDES.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">C     11. &#39;SITHOCPH&#39;  -  THE DATA BASE ACCESS CODE FOR THE HORIZONTAL OCEAN</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">C                        LOADING PHASES.</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">C 3.2.6 SUBROUTINE INTERFACE -</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">C           CALLER SUBROUTINES: INITL</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">C           CALLED SUBROUTINES: DCOS, DSIN, DSQRT, GETA, GETI,</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">C                    GET4, KILL, MMUL2, PUTA, ROTATE, bkplh </span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">C 3.2.7 CONSTANTS USED - EFLAT, REARTH</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">C 3.2.8 PROGRAM VARIABLES -</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">C           1. KERR(10) - THE DATA BASE ERROR RETURN FLAGS.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">C           2. NDO(3)   - THE DATA BASE RETURN ARRAY INDICES.</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">C           3. RY(3,3)  - THE ROTATION MATRIX WHICH PERFORMS A COORDINATE </span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">C                         SYSTEM ROTATION ABOUT THE TOPOCENTRIC Y-AXIS (EAST)</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">C                         THROUGH AN ANGLE EQUAL TO THE GEODETIC LATITUDE OF</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">C                         THE CURRENT SITE. (UNITLESS)</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">C           4. RZ(3,3) -  THE ROTATION MATRIX WHICH PERFORMS A COORDINATE</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">C                         SYSTEM ROTATION ABOUT THE TOPOCENTRIC Z-AXIS (NORTH)</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">C                         THROUGH AN ANGLE EQUAL TO THE NEGATIVE EAST LONGITUDE</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">C                         OF THE CURRENT SITE. (UNITLESS)</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">C 3.2.9 PROGRAMMER - DALE MARKHAM    01/13/77</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">C                    PETER DENATALE  07/13/77</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">C                    BRUCE SCHUPLER  03/08/78</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">C                    CHOPO MA        08/06/81</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">C                    HAROLD M. SCHUH 10/08/83</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">C                    SAVITA GOEL 06/03/87 (CDS FOR A900)</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">C                    LOTHAR MOHLMANN 03/23/89</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">C                    89.07.20 Jim Ryan Documentation simplified.</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">C                    Jim Ryan 89:10:05 CPHYS common made an include file.</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">C                    Jim Ryan 89.12.12 UNIX-like database interface</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">C                                      implimented.</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">C                    MSW 93.03.30 SITCM common and maximum number of station </span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">C                                 variable put into newly created include file</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">C                                 &quot;cmxst.i&quot;.</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">C                    David Gordon 93.10.12 Call to subroutine bkplh added for</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">C                                 geodetic latitude, longitude, and height;</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">C                                 Fixed debug printout errors.</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">C                    David Gordon 94.02.04 HEIGHT(Max_Stat) addded and put into</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">C                                 cmxst.i; heights above geoid (meters).</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">C                    David Gordon 94.04.16 Converted to Implicit None.</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">C                    David Gordon 98.01.22 Modified for station at or near the</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">C                         geocenter, set topocentric stuff to -999 or so.</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">C                    David Gordon 98.03.13 Mods for external site input via</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">C                         an Ascii file.</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">C                    David Gordon 98.03.17 Mods for source a priori&#39;s and ocean</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">C                         loading coefficients in the case of external file </span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">C                         inputs.</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">C                    David Gordon 98.06.26 Add code to compute the &#39;radial-</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">C                         transverse rotation matrices at each site, for use </span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">C                         in the Earth tide module.</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">C                    David Gordon 98.10.26 Add code for optional correlator</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">C                         usage of site velocities. Need input Lcodes </span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">C                         &#39;INTERVAL&#39; and &#39;SITERECV&#39;. New output Lcode is</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">C                         &#39;SITERECS&#39; - modified or not.</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">C                    David Gordon 98.11.05 Put in code to use proposed new </span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">C                         Lcode &#39;INTRVAL4&#39;, the start/stop interval</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">C                         (yr/month/day/hr/min) using a 4-digit year. If</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">C                         not there will use &#39;INTERVAL&#39; (2-digit year).</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">C                         Correlator output site position Lcode changed to</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">C                         &#39;SITEXYZS&#39;, dimensions (3,Max_stat). 10 year limit</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">C                         set on velocity interpolation. </span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">C 3.3   SITI PROGRAM STRUCTURE</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">C   Initialize site positions for correlator usage</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;       <span class="keywordflow">If</span> (calc_user. eq. <span class="stringliteral">&#39;C&#39;</span>) <span class="keywordflow">Then</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;         <span class="keywordflow">do</span> ik=1,max_stat</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          <span class="keywordflow">do</span> kj=1,3</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;           sitxyz(kj,ik) = 0.d0</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordflow">       Endif</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">C     PUT the module text message.</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a4c20993a508f8cf61100bdcc9883ee15">puta</a> (<span class="stringliteral">&#39;SIT MESS      &#39;</span>, lsitm, 40, 1, 1 )</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">C     Use GETA, GETI, &amp; GET4 to obtain the site information from the</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">C       database. All accessed site info goes into COMMON/SITCM/ in cmxst.i.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a3ae66a60ec1589dc5a59d4e0504b3b0c">geti</a> (<span class="stringliteral">&#39;# SITES       &#39;</span>,numsit, 1, 1, 1, ndo, kerr(1) )</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      numsit_local = numsit</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">C-VLBA Do not retrieve site names, we pass Calc the site index </span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">C     numbers directly</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">C      CALL GETA (&#39;SITNAMES      &#39;,LNSITE, 4, NUMSIT_LOCAL, 1, NDO,</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">C     *            KERR(2) )</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;       kerr(2) = 0</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">C-----------------------------------------------------------------------------</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">C  Data base input or external file input for sites? </span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">IF</span> (input_sites) <span class="keywordflow">THEN</span>                    <span class="comment">! Get site info</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;       <span class="keyword">CALL </span><a class="code" href="csitm_8f.html#ae97b72650e85eae768f87ff9ba943531">sitblk</a>(kerr)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">ELSE</span>                                     <span class="comment">! Get site info</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a3ae66a60ec1589dc5a59d4e0504b3b0c">geti</a> (<span class="stringliteral">&#39;AXISTYPS      &#39;</span>,ktype, numsit_local, 1, 1, ndo,</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;     *            kerr(3) )</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#ac8790f309ea371d3baf8c028d6b49e5b">get4</a> (<span class="stringliteral">&#39;AXISOFFS      &#39;</span>,sitaxo,numsit_local, 1, 1, ndo,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;     *            kerr(4) )</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#ac8790f309ea371d3baf8c028d6b49e5b">get4</a> (<span class="stringliteral">&#39;SITEZENS      &#39;</span>,sitzen, numsit_local, 1, 1, ndo,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;     *            kerr(6) )</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">C***********************************************</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">C  Expanded for optional correlator usage of site velocities </span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">C-VLBA Force this IF statement to return false since we apply the </span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">C-VLBA station velocities outside of CALC, but we need calc_user = C</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">C-VLBA elsewhere.</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">C       If (calc_user. eq. &#39;C&#39;) Then</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;       <span class="keywordflow">If</span> (calc_user. eq. <span class="stringliteral">&#39;Z&#39;</span>) <span class="keywordflow">Then</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">C         &#39;SITERECV&#39; should contain X, Y, Z, epoch, X-dot, Y-dot, Z-dot</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">C           for each station, all Real*8. Epoch must be a 4-digit year and </span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">C           fraction  thereof (1998.0, 2001.5, etc.) If Epoch is zero for a</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">C           site, then velocity corrections will be turned off for that site.</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">C           If X=Y=Z=0.D0 (geocenter), then velocity corrections will </span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">C           automatically be turned off.</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keyword">CALL </span><a class="code" href="interface_8f.html#ac8790f309ea371d3baf8c028d6b49e5b">get4</a> (<span class="stringliteral">&#39;SITERECV      &#39;</span>,sitxyzv, 7, numsit_local, 1, ndo,</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;     *            kerx(1) )</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">C !  Apply site velocities from new L-code &#39;SITERECV&#39;</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">If</span> (kerx(1) .eq. 0)  <span class="keywordflow">Then</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">C           Look for 4-digit year interval</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a3ae66a60ec1589dc5a59d4e0504b3b0c">geti</a> (<span class="stringliteral">&#39;INTRVAL4      &#39;</span>,intrvl, 5, 2, 1, ndo, kerx(2) )</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">C           If no 4-digit year interval, get 2-digit year interval</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;         <span class="keywordflow">If</span> (kerx(2).ne.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a3ae66a60ec1589dc5a59d4e0504b3b0c">geti</a> (<span class="stringliteral">&#39;INTERVAL      &#39;</span>,intrvl, 5, 2, 1, ndo, kerx(2) )</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">C            Convert 2-digit year to 4-digit year</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          <span class="keywordflow">If</span> (intrvl(1,1) .ge. 70 .and. intrvl(1,1) .le. 99) </div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;     *        intrvl(1,1) = intrvl(1,1)+1900</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;          <span class="keywordflow">If</span> (intrvl(1,1) .ge.  0 .and. intrvl(1,1) .le. 69) </div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;     *        intrvl(1,1) = intrvl(1,1)+2000</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordflow">         Endif</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">C  Convert start time to year and fraction, not worrying about leap years:</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;           xdoy1 = imdoy(intrvl(2,1)) + intrvl(3,1) + intrvl(4,1)/24.d0 </div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;     *             + intrvl(5,1)/1440.d0 </div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;           xepoch = intrvl(1,1) + xdoy1/365.d0</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;             <span class="keywordflow">Do</span> ik = 1, numsit_local</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;              x_frac = xepoch - sitxyzv(4,ik)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">C              Turn off corrections if no position epoch or at the geocenter</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="keywordflow">If</span> (sitxyzv(4,ik) .eq. 0.d0) x_frac = 0.d0</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                <span class="keywordflow">If</span> ( (dabs(sitxyzv(1,ik)) .le. 1.d-6) .and.</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;     *               (dabs(sitxyzv(2,ik)) .le. 1.d-6) .and.</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;     *               (dabs(sitxyzv(3,ik)) .le. 1.d-6) )  x_frac = 0.d0</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">C               Make sure interpolation is over no more than 10 years!!</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                 <span class="keywordflow">If</span> (dabs(x_frac) .gt. 10.d0) <span class="keywordflow">Then</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                  <span class="keyword">Write</span>(6,147) ik, xepoch, sitxyzv(4,ik)    </div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; 147              <span class="keyword">Format</span>(<span class="stringliteral">&#39; Problem in SITI for Site #&#39;</span>,i2,</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;     *             <span class="stringliteral">&#39;, Data epoch = &#39;</span>,f10.2, <span class="stringliteral">&#39;, Site epoch = &#39;</span>,f10.2,/,</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;     *             <span class="stringliteral">&#39; Maximum difference allowed is 10 years!! Check&#39;</span>,</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;     *             <span class="stringliteral">&#39; input codes SITERECV and INTRVAL4/INTERVAL. &#39;</span>) </div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a> (6hsiti  , 0, 0 )</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                  stop</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keywordflow">                 Endif</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">C </span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;               <span class="keywordflow">Do</span> kj = 1, 3</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">C                   Add motion rounded to nearest 0.1 mm</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                 intmov = sitxyzv(kj+4,ik)*x_frac*1.d4 + .49d0</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                sitxyz(kj,ik) = sitxyzv(kj,ik) + intmov/1.d4</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keywordflow">               Enddo</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keywordflow">             Enddo</span> </div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">C !  No site velocities, use old L-code</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">Else</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          <span class="keyword">CALL </span><a class="code" href="interface_8f.html#ac8790f309ea371d3baf8c028d6b49e5b">get4</a> (<span class="stringliteral">&#39;SITERECS      &#39;</span>,sitxyz, 3, numsit_local, 1, ndo,</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;     *            kerr(5) )</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keywordflow">        Endif</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">C   Write out new/old site coordinates for Correlator capture</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keyword">CALL </span><a class="code" href="interface_8f.html#aaec75c0e539fcc5c41612a47078fbb5c">putr</a>(<span class="stringliteral">&#39;SITEXYZS      &#39;</span>, sitxyz, 3, max_stat, 1)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;       <span class="keywordflow">Else</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keyword">CALL </span><a class="code" href="interface_8f.html#ac8790f309ea371d3baf8c028d6b49e5b">get4</a> (<span class="stringliteral">&#39;SITERECS      &#39;</span>,sitxyz, 3, numsit_local, 1, ndo,</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;     *            kerr(5) )</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keywordflow">       Endif</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">C***********************************************</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keywordflow">      ENDIF</span>                                    <span class="comment">! Get site info</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">C  Check for a geocenter station and set flag if so</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      zero_site = 0</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keywordflow">Do</span> i = 1, numsit</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">If</span> ( (dabs(sitxyz(1,i)) .le. 1.d-6) .and.</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;     *       (dabs(sitxyz(2,i)) .le. 1.d-6) .and.</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;     *       (dabs(sitxyz(3,i)) .le. 1.d-6) )  <span class="keywordflow">Then</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          <span class="keywordflow">If</span> (zero_site .eq. 0) <span class="keywordflow">Then</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;           zero_site = i</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">C           Write(6,&#39;(&quot;SITI: Goecenter site = site # &quot;,I3)&#39;) Zero_site</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;          <span class="keywordflow">Else</span>      <span class="comment">! More than one geocenter site! Not allowed!</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;           <span class="keyword">Write</span>(6,<span class="stringliteral">&#39;(&quot;SITBLK: More than 1 geocenter site! Quitting!&quot;)&#39;</span>)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;           <span class="keyword">CALL </span><a class="code" href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a> (6hsiti  , 0, 0 )</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keywordflow">          Endif</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordflow">        Endif</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordflow">      Enddo</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">C-----------------------------------------------------------------------------</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">C  Data base input or external file input for ocean loading?</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordflow">IF</span> (input_ocean) <span class="keywordflow">THEN</span>        <span class="comment">! Database/external file ocean loading?</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;       <span class="keyword">CALL </span><a class="code" href="csitm_8f.html#a640a106fb8f7ce53f206e6381b7fd067">ocnin</a>(kerr)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">ELSE</span>                         <span class="comment">! Database/external file ocean loading?</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#ac8790f309ea371d3baf8c028d6b49e5b">get4</a> (<span class="stringliteral">&#39;SITOCAMP      &#39;</span>,sitoam, 11, numsit_local, 1,ndi,</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;     *            kerr(7) )</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#ac8790f309ea371d3baf8c028d6b49e5b">get4</a> (<span class="stringliteral">&#39;SITOCPHS      &#39;</span>,sitoph, 11, numsit_local, 1,ndi,</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;     *            kerr(8) )</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#ac8790f309ea371d3baf8c028d6b49e5b">get4</a> (<span class="stringliteral">&#39;SITHOCAM      &#39;</span>,sithoa, 11,2, numsit_local, ndi,</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;     *            kerr(9) )</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;       <span class="keyword">CALL </span><a class="code" href="interface_8f.html#ac8790f309ea371d3baf8c028d6b49e5b">get4</a> (<span class="stringliteral">&#39;SITHOCPH      &#39;</span>,sithop, 11,2, numsit_local, ndi,</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;     *            kerr(10) )</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;       <span class="keywordflow">IF</span>(kerr(9).NE.0  .OR. kerr(10).NE.0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;         <span class="keywordflow">DO</span> i = 1,11</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;           <span class="keywordflow">DO</span> j = 1,2</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;             <span class="keywordflow">DO</span> k = 1,numsit_local</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;               sithoa(i,j,k) = 0.d0</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;               sithop(i,j,k) = 0.d0</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordflow">             ENDDO</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="keywordflow">           ENDDO</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keywordflow">         ENDDO</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        kerr(9)  = 0</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        kerr(10) = 0</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordflow">If</span>(kocec.ne.3) <span class="keywordflow">Then</span>       <span class="comment">!See if the user wants to go on.</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;          <span class="keyword">WRITE</span>(6,<span class="stringliteral">&#39;(///,</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     .    &quot;WARNING: This database does not contain horizontal ocean loa&quot;</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     .    ,&quot;ding amplitudes and&quot;,/,</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     .    &quot;phases.  Arrays for all sites zeroed out.&quot;,//,</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     .    &quot;Continue (y/(n)) ?&quot;,$)&#39;</span>)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;          itest = <span class="stringliteral">&#39;N&#39;</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;          <span class="keyword">READ</span>(5,<span class="stringliteral">&#39;(A)&#39;</span>) itest</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;          <span class="keywordflow">IF</span>(itest.ne.<span class="stringliteral">&#39;Y&#39;</span> .and. itest.ne.<span class="stringliteral">&#39;y&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            kerr(9)  = 0</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            kerr(10) = 0</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keywordflow">          ENDIF</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">Else</span>         <span class="comment">!If the ocean loading module control flag is 3 proceed!</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;          <span class="keyword">Write</span>(6,<span class="stringliteral">&#39;(</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     .    &quot; Proceeding with null horizontal ocean loading catalog!&quot;)&#39;</span>)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keywordflow">        Endif</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keywordflow">       ENDIF</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordflow">      ENDIF</span>                        <span class="comment">! Database/external file ocean loading?</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">C-----------------------------------------------------------------------------</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordflow">IF</span> (.Not. input_sites) <span class="keywordflow">THEN</span> </div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">C     If only one site zenith path delay, copy for all stations.</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;       <span class="keywordflow">IF</span>( ndo(1) .NE. numsit ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;         <span class="keywordflow">DO</span> 210 n = 2,numsit</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; 210       sitzen(n) = sitzen(1)</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="keywordflow">       ENDIF</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">C     Check for database interface errors. If an error is found, KILL.</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;       <span class="keywordflow">DO</span> n = 1,5</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;           nn = n</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;           <span class="keywordflow">IF</span> ( kerr(nn) .NE. 0 ) <span class="keyword">CALL </span><a class="code" href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a> (6hsiti  , nn, kerr(nn) )</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keywordflow">       ENDDO</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">C     There may be only one site zenith atmosphere delay.</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;       <span class="keywordflow">IF</span>( kerr(6) .NE. 0 .AND. kerr(6) .NE. 2 )</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;     .     <span class="keyword">CALL </span><a class="code" href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a> (6hsiti  , 6, kerr(6) )</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="keywordflow">      ENDIF</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">C     Check for database interface errors _ ocean loading.</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">DO</span> 302 n = 7,10</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        nn = n</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">IF</span>( kerr(n) .EQ. 0) <span class="keywordflow">GO TO</span> 302</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;          <span class="keyword">CALL </span><a class="code" href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a> (6hsiti  ,nn, kerr(nn))</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; 302  <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">C     Calculate the neccesary site geometry.</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">C      Mod added 98JAN22: Dummy out topocentric type variables for station at</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">C      or near the geocenter, for correlator usage. </span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">C     Loop once for each station in the site catalog.</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="keywordflow">DO</span> 490  n = 1,numsit</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">C       Compute the site spherical radii.</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        cfrad(n) = dsqrt( sitxyz(1,n)**2  +  sitxyz(2,n)**2  +</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;     1                     sitxyz(3,n)**2  )</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">C   Check for geocenter</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;         <span class="keywordflow">If</span> (zero_site .eq. n) <span class="keywordflow">Go to</span> 491</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">C   Compute geocentric latitudes</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;         glat(n) = dasin( sitxyz(3,n) / cfrad(n) )</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">C   93OCT12. Call subroutine bkplh to compute </span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">C    geodetic latitude, geodetic longitude, and height. DG </span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;         pie = pi</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;         fl = eflat</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;         a = rearth</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;         <span class="keywordflow">do</span> i=1,3</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          xyz(i)=sitxyz(i,n)</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keyword">call </span><a class="code" href="csitm_8f.html#afcf454f0870373286c49c69ffb2375c0">bkplh</a>(xyz,xlatlonht,pie,a,fl) </div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">C keep longitudes between -PI and +PI</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;         <span class="keywordflow">if</span> (xlatlonht(2) .gt. pi)</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;     .       xlatlonht(2) = xlatlonht(2) - 2.d0*pi</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;         xlat(n)  =  xlatlonht(1) </div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;         xlon(n)  =  xlatlonht(2) </div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;         height(n) = xlatlonht(3)     <span class="comment">! height in meters</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">C         write (6,*)&quot;lat, long, h = &quot;,n,xlat(n)*360.0/TWOPI,</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">C     .   xlon(n)*360.0/TWOPI,height(n)</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">C       Compute the site normal unit vectors.</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        snrm(1,n) = dcos( xlat(n) ) * dcos( xlon(n) )</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        snrm(2,n) = dcos( xlat(n) ) * dsin( xlon(n) )</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        snrm(3,n) = dsin( xlat(n) )</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">C       Compute the partial derivatives of the crust fixed site</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">C       coordinates with respect to the East longitudes.</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        plon(1,n) = - sitxyz(2,n)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        plon(2,n) =   sitxyz(1,n)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        plon(3,n) =   0.d0</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">C       Compute the partial derivatives of the crust fixed site</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">C       coordinates with respect to the geodetic latitudes.</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">C       (NOTE: The following equations are actually for the geocentric partial</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">C       derivatives, however, these partials are sufficiently close to the</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">C       geodetic partials for the purposes of CALC use.)</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        plat(1,n) = - sitxyz(3,n) * dcos(xlon(n) )</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        plat(2,n) = - sitxyz(3,n) * dsin(xlon(n) )</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        plat(3,n) = + cfrad(n) * dcos(xlat(n) )</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">C     Compute the topocentric-to-crust-fixed rotation matrices by rotating </span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">C     about the geodetic latitude and the longitude. Also now compute a </span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">C     &quot;radial-transverse&quot; rotation matrix by rotating about the geocentric</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">C     latitude and the longitude. </span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        xlat_dummy = xlat(n)</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keyword">CALL </span><a class="code" href="cmatu_8f.html#a244b79ca75dda565e26ccbc7e6a27059">rotat</a> ( xlat_dummy, 2, ry )</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">c      write(6,8) &#39; XLAT? &#39;,  xlat(n)*57.29578 </span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        xlon_dummy = xlon(n)</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keyword">CALL </span><a class="code" href="cmatu_8f.html#a244b79ca75dda565e26ccbc7e6a27059">rotat</a> ( -xlon_dummy, 3, rz )</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">c      write(6,8) &#39; XLON? &#39;,  xlon(n)*57.29578 </span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        glat_dummy = glat(n)</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keyword">CALL </span><a class="code" href="cmatu_8f.html#a244b79ca75dda565e26ccbc7e6a27059">rotat</a> ( glat_dummy, 2, rgy )</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">c      write(6,8) &#39; GLAT? &#39;,  glat(n)*57.29578 </span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">c       DO I=1,3</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">c         DO J=1,3</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">c           TCROT_DUMMY(I,J) = TCROT(I,J,N)</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">c           RTROT_DUMMY(I,J) = RTROT(I,J,N)</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">c         ENDDO</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">c       ENDDO</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keyword">CALL </span><a class="code" href="cmatu_8f.html#a0c394eb642450bfe952b048edac108f8">mmul2</a> ( rz, ry, tcrot_dummy(1,1) )</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keyword">CALL </span><a class="code" href="cmatu_8f.html#a0c394eb642450bfe952b048edac108f8">mmul2</a> ( rz, rgy,rtrot_dummy(1,1) )</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordflow">DO</span> i=1,3</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;          <span class="keywordflow">DO</span> j=1,3</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            tcrot(i,j,n) = tcrot_dummy(i,j)</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            rtrot(i,j,n) = rtrot_dummy(i,j)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="keywordflow">          ENDDO</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keywordflow">        ENDDO</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">c      write(6,8) &#39; TCROT &#39;,  TCROT_DUMMY </span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">c      write(6,8) &#39; RTROT &#39;,  RTROT_DUMMY </span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keywordflow">IF</span> (ksitd .ne. 0) <span class="keywordflow">Then</span>  <span class="comment">!Station debug printout</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;       <span class="keywordflow">if</span> (n.eq.1) <span class="keywordflow">Then</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keyword">WRITE</span> ( 6, 1)</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; EFLAT   &#39;</span>,eflat</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; REARTH  &#39;</span>,rearth</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keyword">WRITE</span>(6,7)<span class="stringliteral">&#39; NUMSIT  &#39;</span>,numsit</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="keywordflow">       endif</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    1  <span class="keyword">FORMAT</span> (1x, <span class="stringliteral">&#39;Debug output for subroutine SITI.&#39;</span> )</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;       <span class="keyword">write</span>(6,<span class="stringliteral">&#39;(&quot; For site #&quot;,i2)&#39;</span>) n</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;       <span class="keyword">WRITE</span>(6,4)<span class="stringliteral">&#39; RY   &#39;</span>,((ry(j,k),j=1,3),k=1,3)</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;       <span class="keyword">WRITE</span>(6,4)<span class="stringliteral">&#39; RZ   &#39;</span>,((rz(j,k),j=1,3),k=1,3)</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;       <span class="keyword">WRITE</span>(6,4)<span class="stringliteral">&#39; RGY  &#39;</span>,((rgy(j,k),j=1,3),k=1,3)</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;       <span class="keyword">WRITE</span> (6,8)<span class="stringliteral">&#39; Geoid Height  &#39;</span>,  xlatlonht(3) </div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="keywordflow">      Endif</span>          <span class="comment">!Station debug printout</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="keywordflow">GO TO</span> 490</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  491 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">C    Dummy out the above topocentric quantities, they have no meaning at the</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">C     geocenter</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        xlat(n)   = -999.d0</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        xlon(n)   = -999.d0</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        height(n) = -999.d0</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        snrm(1,n) = 0.d0</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        snrm(2,n) = 0.d0</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        snrm(3,n) = 0.d0</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        glat(n)   = -999.d0</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        plon(1,n) = 0.d0</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        plon(2,n) = 0.d0</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        plon(3,n) = 0.d0</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        plat(1,n) = 0.d0</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        plat(2,n) = 0.d0</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        plat(3,n) = 0.d0</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        sitaxo(n) = 0.d0</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        ktype(n)  = 0</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        sitzen(n) = 0.d0</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordflow">DO</span> i=1,3</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;         <span class="keywordflow">DO</span> j=1,3</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          tcrot(i,j,n) = 0.d0</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;          rtrot(i,j,n) = 0.d0</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keywordflow">         ENDDO</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="keywordflow">        ENDDO</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">DO</span> i=1,11</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          sitoam(i,n) = 0.d0</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          sithoa(i,1,n) = 0.d0</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          sithoa(i,2,n) = 0.d0</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          sitoph(i,n) = 0.d0</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          sithop(i,1,n) = 0.d0</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;          sithop(i,2,n) = 0.d0</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keywordflow">        ENDDO</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">C     Close the loop which runs over the sites in the catalog.</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  490 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">C     Initialize the integer variable NLAST to zero.</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      nlast(1) = 0</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      nlast(2) = 0</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">C     Check KSITD for debug output.</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordflow">IF</span> ( ksitd .ne. 0 ) <span class="keywordflow">Then</span>  <span class="comment">!Debug printout</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">C     WRITE ( 6, 11)</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   11 <span class="keyword">FORMAT</span> (1x, <span class="stringliteral">&#39;Station Debug for subroutine SITI.&#39;</span> )</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; CFRAD   &#39;</span>,(cfrad(j),j=1,numsit)</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    8 <span class="keyword">FORMAT</span>(a,4d25.16/(7x,5d25.16))</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keyword">WRITE</span>(6,7)<span class="stringliteral">&#39; KTYPE   &#39;</span>,(ktype(j),j=1,numsit)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    7 <span class="keyword">FORMAT</span>(/,a,15i8/(7x,15i8))</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keyword">WRITE</span>(6,7)<span class="stringliteral">&#39; NLAST   &#39;</span>,nlast</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keyword">WRITE</span>(6,4)<span class="stringliteral">&#39; PLAT    &#39;</span>,(( plat(j,k),j=1,3),k=1,numsit)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    4 <span class="keyword">FORMAT</span>(/,a,3d25.16/(9x,3d25.16))</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="keyword">WRITE</span>(6,4)<span class="stringliteral">&#39; PLON    &#39;</span>,(( plon(j,k),j=1,3),k=1,numsit)</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; SITAXO  &#39;</span>,( sitaxo(j),j=1,numsit)</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keyword">WRITE</span>(6,9)<span class="stringliteral">&#39; SITOAM, &#39;</span>,((sitoam(j,k),j=1,11),k=1,numsit)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keyword">WRITE</span>(6,9)<span class="stringliteral">&#39; SITOPH, &#39;</span>,((sitoph(j,k),j=1,11),k=1,numsit)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keyword">WRITE</span>(6,9)<span class="stringliteral">&#39; SITHOA, &#39;</span>,(((sithoa(j,l,k),j=1,11),l=1,2),k=1,</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;     .numsit)</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="keyword">WRITE</span>(6,9)<span class="stringliteral">&#39; SITHOP, &#39;</span>,(((sithop(j,l,k),j=1,11),l=1,2),k=1,</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;     .numsit)</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    9 <span class="keyword">FORMAT</span>(/,a,11f9.4,/,(9x,11f9.4))</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keyword">WRITE</span>(6,6)<span class="stringliteral">&#39; SITXYZ  &#39;</span>,((sitxyz(j,k),j=1,3),k=1,numsit)</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    6 <span class="keyword">FORMAT</span>(/,a,3f20.4,/,(9x,3f20.4))</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; SITZEN  &#39;</span>,(sitzen(k),k=1,numsit)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="keyword">WRITE</span>(6,4)<span class="stringliteral">&#39; SNRM    &#39;</span>,((snrm(i,j),i=1,3),j=1,numsit)</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keyword">WRITE</span>(6,4)<span class="stringliteral">&#39; TCROT   &#39;</span>,(((tcrot(i,j,k),i=1,3),j=1,3),k=1,</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;     .numsit)</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    5 <span class="keyword">FORMAT</span>(/,a,/,3(3f20.4,/)/)</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; XLAT    &#39;</span>,(xlat(j),j=1,numsit)</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; XLON    &#39;</span>,(xlon(j),j=1,numsit)</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; HEIGHT    &#39;</span>,(height(j),j=1,numsit)</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keyword">WRITE</span>(6,3)<span class="stringliteral">&#39; LNSITE  &#39;</span>,((lnsite(j,k),j=1,4),k=1,numsit)</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    3 <span class="keyword">FORMAT</span> (/,a,4a2,/, 9x,4a2/)</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="keywordflow">      Endif</span>          <span class="comment">!Debug printout</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">C     Normal conclusion.</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">C******************************************************************************</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="csitm_8f.html#ae33d05b01559c9c88ffe00c97a87d9e0">sitg</a> ( AXOFF, CFBASE, CFLAT, CFLON, CFSITE, CFSITN,</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;     1                  KAXIS, OCEAMP, OCEPHS,  SITLAT, SITLON, SITRAD,</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;     2                  TCTOCF, RTTOCF, ZPATH, SITHEIGHT, GEOLAT)</div><div class="line"><a name="l00714"></a><span class="lineno"><a class="line" href="csitm_8f.html#ae33d05b01559c9c88ffe00c97a87d9e0">  714</a></span>&#160;      <span class="keywordtype">IMPLICIT None</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">C 4.    SITG</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">C 4.1   SITG PROGRAM SPECIFICATION</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">C 4.1.1 SITG is the Site Module geometry section. SITG calculates the site</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">C       geometry for the stations participating in the current observation.</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">C 4.1.2 RESTRICTIONS - NONE</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">C 4.1.3 REFERENCES - MARKHAM&#39;S X-DOCUMENT</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">C 4.2   SITG PROGRAM INTERFACE</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">C 4.2.1 CALLING SEQUENCE -</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">C </span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">C         OUTPUT VARIABLES: </span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">C           1. AXOFF(2)      - THE ANTENNA AXIS OFFSETS AT EACH SITE. (M)</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">C           2. CFBASE(3)     - THE CRUST FIXED BASELINE VECTOR. (M) </span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">C           3. CFLAT(3,2)    - THE PARTIAL DERIVATIVES OF THE SITE CRUST FIXED</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">C                              VECTOR COMPONENTS WITH RESPECT TO THE GEODETIC</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">C                              LATITUDES AT EACH OBSERVATION SITE. (M/RAD) </span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">C           4. CFLON(3,2)    - THE PARTIAL DERIVATIVES OF THE SITE CRUST FIXED</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">C                              VECTOR COMPONENTS WITH RESPECT TO THE EAST</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">C                              LONGITUDES AT EACH OBSERVATION SITE.  (M/RAD)</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">C           5. CFSITE(3,2)   - THE CRUST FIXED SITE VECTORS AT EACH SITE. (M)</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">C           6. CFSITN(3,2)   - THE CRUST FIXED SITE NORMAL UNIT VECTORS AT</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">C                              EACH OBSERVATION SITE. (UNITLESS)</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">C           7. KAXIS(2)      - THE ANTENNA AXIS TYPES FOR EACH SITE. (UNITLESS)</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">C           8. OCEAMP(11,3,2)- THE TOPOCENTRIC OCEAN LOADING AMPLITUDES FOR</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">C                    ( J,K,L)  THE 11 MAIN TIDES (J=1,11),</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">C                                      K=1 : VERTICAL,</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">C                                      K=2 : EAST-WEST, AND</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">C                                      K=3 : NORTH-SOUTH DIRECTION</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">C                               FOR EACH OBSERVATION SITE (L=1,2). (M)</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">C           9. OCEPHS(11,3,2)- THE OCEAN LOADING PHASES AT EACH SITE. (RAD)</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">C          10. SITLAT(2)     - THE GEODETIC LATITUDE AT EACH SITE. (RAD)</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">C          11. SITLON(2)     - THE EAST LONGITUDE AT EACH SITE. (RAD)</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">C          12. SITRAD(2)     - THE SPHERICAL EARTH RADIUS OF EACH SITE. (M)</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">C          13. TCTOCF(3,3,2) - THE ROTATION MATRIX WHICH ROTATES THE</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">C                              TOPOCENTRIC REFERENCE SYSTEM TO THE CRUST FIXED</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">C                              REFERENCE SYSTEM AT EACH SITE. (UNITLESS)</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">C          14. RTTOCF(3,3,2) - The rotation matrix which rotates the </span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">C                              &#39;radial-transverse&#39; reference system to the </span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">C                              crust fixed reference system at each site.</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">C          15. ZPATH(2)      - THE ZENITH ELECTRICAL PATH LENGTH AT EACH </span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">C                              OBSERVATION SITE.  (SEC)</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">C          16. SITHEIGHT(2)  - The height above the geoid at each site. (m)</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">C          17. GEOLAT(2)     - The geocentric latitude at each site. (rad)</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      include <span class="stringliteral">&#39;cmxst.i&#39;</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      include <span class="stringliteral">&#39;cobsn.i&#39;</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">C          Variables from:</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">C            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">C                         then used downstream. Otherwise equals zero. For </span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">C                         correlator usage.</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      include <span class="stringliteral">&#39;ccon.i&#39;</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">C          VARIABLES &#39;FROM&#39;:</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">C            1.  KSITC  -  THE SITE MODULE FLOW CONTROL FLAG.</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">C            2.  KSITD  -  THE SITE MODULE DEBUG OUTPUT FLAG.</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">C 4.2.3 PROGRAM SPECIFICATIONS -</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="keywordtype">Real*8</span>  AXOFF(2),CFBASE(3),CFLAT(3,2),CFLON(3,2),CFSITE(3,2),</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;     1        cfsitn(3,2),oceamp(11,3,2),ocephs(11,3,2),sitlat(2),</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;     2        sitlon(2),sitrad(2),tctocf(3,3,2),zpath(2),sitheight(2),</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;     3        rttocf(3,3,2), geolat(2)</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordtype">Integer*2</span>  KAXIS(2), LNBASE(4,2), NDO(3), KERR, IDBASE(2)</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keywordtype">Integer*4</span>  I, J, K, L, N, NN</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">C 4.2.4 DATA BASE ACCESS -</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">C          &#39;GET&#39; VARIABLES:</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">C            1. LNBASE(4,2) - THE EIGHT CHARACTER SITE NAMES OF THE BASELINE</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">C                             OF THE CURRENT OBSERVATION. (ALPHAMERIC) </span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">C          ACCESS CODES:</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">C            1. &#39;BASELINE&#39; - THE DATA BASE ACCESS CODE FOR THE BASELINE</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">C                            IDENTIFICATION OF THE CURRENT OBSERVATION.</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">C 4.2.6 SUBROUTINE INTERFACE -</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">C           CALLER SUBROUTINES: DRIVG</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">C           CALLED SUBROUTINES: GETA, KILL, VECSB</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">C 4.2.7 CONSTANTS USED - NONE</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">C 4.2.8 PROGRAM VARIABLES -</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">C            1.  KERR     -  THE DATA BASE ERROR RETURN FLAG.</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">C            2.  NDO(3)   -  THE DATA BASE RETURN ARRAY INDICES.</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">C            3.  LOC...(4) - CONTAINS THE NAMES OF THE STATIONS WITH KNOWN</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">C                            PARAMETERS OF HORIZONTAL DISPLACEMENT DUE TO </span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">C                            OCEAN LOADING.</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">C 4.2.9 PROGRAMMER - DALE MARKHAM    01/13/77</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">C                    PETER DENATALE  07/13/77</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">C                    CHOPO MA        08/06/81</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">C                    HAROLD M. SCHUH 10/08/83</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">C                    SAVITA GOEL 06/03/87 (CDS FOR A900)</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">C                    LOTHAR MOHLMANN 03/23/89</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">C                    89.07.20 Jim Ryan Documentation simplified.</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">C                    Jim Ryan 89.12.12 UNIX-like database interface</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">C                                      implimented.</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">C                    93.03.30 MSW SITCM common and maximum number of station</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">C                             variable put into newly created include file</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">C                             &quot;cmxst.i&quot;.</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">C                    94.02.04 David Gordon SITHEIGHT(2) added, station heights </span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">C                             above geoid (meters).</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">C                    David Gordon 94.04.16 Converted to Implicit None.</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">C                    David Gordon 98.06.26 Adding rotation matrix RTTOCF(3,3,2)</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">C                             and geocentric latitudes GEOLAT(2), for use later</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">C                             in the solid Earth tide module.</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">C                    David Gordon 98.07.29 Added &#39;Include cobsn.i&#39; with </span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">C                             variable Nzero, and code to determine when a </span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">C                             station is at the geocenter.</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">C     SITG program structure.</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">C     GET the baseline name. Check for errors.</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">C-VLBA Modified to support the VLBA Correlator. Baseline station index</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">C     numbers are supplied by modlTask.</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">C      CALL GETA (&#39;BASELINE      &#39;, LNBASE, 4, 2, 1, NDO, KERR )</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#a3ae66a60ec1589dc5a59d4e0504b3b0c">geti</a> (<span class="stringliteral">&#39;BASELINE      &#39;</span>, idbase, 2, 1, 1, ndo, kerr)</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <span class="keywordflow">IF</span> ( kerr .EQ. 0 ) <span class="keywordflow">GO TO</span> 310</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keyword">CALL </span><a class="code" href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a> (6hsitg  , 1, kerr )</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">C-VLBA moved this to later in this module in order to support geocentric</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">C single station baselines and two station baselines on the surface of</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">C the earth.</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">C   Set geocenter indicator to zero</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">C      Nzero = 0</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">C     Construct the arrays to hold the geometry of the stations participating </span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">C     in the current observation so that this information can be passed to the</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">C     rest of the program.</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">C     Loop for sites 1 and 2.</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  310 <span class="keywordflow">DO</span> 3130  l = 1,2</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      n = idbase(l)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">C       Determine the identification of the stations participating in</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">C       the current observation. If the baseline identification is not</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">C       successful, a message is written and the program terminates.</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">C        DO 320  NN = 1, NUMSIT</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">C          N = NN</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">C          IF   ( ( LNSITE(1,NN) .EQ. LNBASE(1,L) )</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">C     1    .AND.  ( LNSITE(2,NN) .EQ. LNBASE(2,L) )</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">C     2    .AND.  ( LNSITE(3,NN) .EQ. LNBASE(3,L) )</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">C     3    .AND. ( LNSITE(4,NN) .EQ. LNBASE(4,L) ) )  GO TO 330</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">C  320   CONTINUE</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">C        GO TO 700</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">C       Check to see if the ID of the baseline has changed from that of the</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">C       previous observation. If not, then retain the current site geometry.</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  330   <span class="keywordflow">IF</span> ( nlast(l) .EQ. n )  <span class="keywordflow">GO TO</span> 3130</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        nlast(l) = n</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">C       Construct the array to hold the crust fixed site vectors.</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        cfsite(1,l) = sitxyz(1,n)</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        cfsite(2,l) = sitxyz(2,n)</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        cfsite(3,l) = sitxyz(3,n)</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">C       Construct the array to hold the site spherical radii.</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        sitrad(l) = cfrad(n)</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">C       Construct the array to hold the site normal unit vectors.</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        cfsitn(1,l) = snrm(1,n)</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        cfsitn(2,l) = snrm(2,n)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        cfsitn(3,l) = snrm(3,n)</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">C       Construct the arrays to hold the geodetic latitudes and the East</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">C       longitudes. Also now an array for geocentric latitude.</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        sitlat(l) = xlat(n)</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        sitlon(l) = xlon(n)</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        sitheight(l) = height(n)</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        geolat(l) = glat(n)</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">C       Construct arrays to hold the partial derivatives of the crust fixed site</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">C       coordinates with respect to the longitudes and the geodetic latitudes.</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        cflon(1,l) = plon(1,n)</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        cflon(2,l) = plon(2,n)</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        cflon(3,l) = plon(3,n)</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        cflat(1,l) = plat(1,n)</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        cflat(2,l) = plat(2,n)</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        cflat(3,l) = plat(3,n)</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">C       Construct the array to hold the site antenna axis offsets.</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        axoff(l) = sitaxo(n)</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">C       Construct the array to hold the site antenna types.</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        kaxis(l) = ktype(n)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">C       Construct the array to hold the topocentric to crust fixed</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">C       rotation matrices. Now also an array for the radial-transverse </span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">C       rotation matrices.</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">DO</span> 3112  j = 1,3</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;          <span class="keywordflow">DO</span> 3111  i = 1,3</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            tctocf(i,j,l) = tcrot(i,j,n)</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            rttocf(i,j,l) = rtrot(i,j,n)</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; 3111     <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; 3112   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">C       Construct the array to hold the zenith electrical path lengths</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        zpath(l) = sitzen(n)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">C       Construct the arrays to hold the site ocean loading amplitudes</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">C       and phases.</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordflow">DO</span> j = 1, 11</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;          oceamp(j,1,l) = sitoam(j,n)</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;          oceamp(j,2,l) = sithoa(j,1,n)</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;          oceamp(j,3,l) = sithoa(j,2,n)</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;          ocephs(j,1,l) = sitoph(j,n)</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;          ocephs(j,2,l) = sithop(j,1,n)</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          ocephs(j,3,l) = sithop(j,2,n)</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="keywordflow">        ENDDO</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">C  Check for geocenter station</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;       <span class="keywordflow">If</span>(zero_site .eq. 0) nzero = 0</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;       <span class="keywordflow">If</span>(zero_site .ne. 0 .and. n .eq. zero_site) <span class="keywordflow">Then</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        nzero = n</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">C        print *, &#39; SITG: Geocenter Site Found, Nzero =  &#39;, Nzero</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="keywordflow">       Endif</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">C     Close the loop which runs over the sites.</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; 3130 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">C     Construct the array to hold the crust fixed baseline vector.</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keyword">CALL </span><a class="code" href="cvecu_8f.html#a6a89e2feb2a4f077a63790728a419430">vecsb</a> ( cfsite(1,1), cfsite(1,2), cfbase )</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">C     Check KSITD for debug output.</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <span class="keywordflow">IF</span> ( ksitd .EQ. 0 )  <span class="keywordflow">GO TO</span> 600</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keyword">WRITE</span> ( 6, 1)</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    1 <span class="keyword">FORMAT</span> (1x, <span class="stringliteral">&#39;Debug output for subroutine SITG.&#39;</span> )</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; CFRAD   &#39;</span>,(cfrad(j),j=1,numsit)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    8 <span class="keyword">FORMAT</span>(a,4d25.16/(7x,5d25.16))</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="keyword">WRITE</span>(6,7)<span class="stringliteral">&#39; KTYPE   &#39;</span>,(ktype(j),j=1,numsit)</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    7 <span class="keyword">FORMAT</span>(/,a,15i8/(7x,15i8))</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <span class="keyword">WRITE</span>(6,7)<span class="stringliteral">&#39; NLAST   &#39;</span>,nlast</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <span class="keyword">WRITE</span>(6,7)<span class="stringliteral">&#39; NUMSIT  &#39;</span>,numsit</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="keyword">WRITE</span>(6,4)<span class="stringliteral">&#39; PLAT    &#39;</span>,(( plat(j,k),j=1,3),k=1,numsit)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    4 <span class="keyword">FORMAT</span>(/,a,3d25.16/(9x,3d25.16))</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="keyword">WRITE</span>(6,4)<span class="stringliteral">&#39; PLON    &#39;</span>,(( plon(j,k),j=1,3),k=1,numsit)</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; SITAXO  &#39;</span>,( sitaxo(j),j=1,numsit)</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keyword">WRITE</span>(6,9)<span class="stringliteral">&#39; SITOAM, &#39;</span>,((sitoam(j,k),j=1,11),k=1,numsit)</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keyword">WRITE</span>(6,9)<span class="stringliteral">&#39; SITOPH, &#39;</span>,((sitoph(j,k),j=1,11),k=1,numsit)</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="keyword">WRITE</span>(6,9)<span class="stringliteral">&#39; SITHOA, &#39;</span>,(((sithoa(j,l,k),j=1,11),l=1,2),k=1,</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;     .numsit)</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keyword">WRITE</span>(6,9)<span class="stringliteral">&#39; SITHOP, &#39;</span>,(((sithop(j,l,k),j=1,11),l=1,2),k=1,</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;     .numsit)</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    9 <span class="keyword">FORMAT</span>(/,a,11f7.4,/,(9x,11f7.4))</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keyword">WRITE</span>(6,6)<span class="stringliteral">&#39; SITXYZ  &#39;</span>,((sitxyz(j,k),j=1,3),k=1,numsit)</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    6 <span class="keyword">FORMAT</span>(/,a,3f20.4,/,(9x,3f20.4))</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; SITZEN  &#39;</span>,(sitzen(k),k=1,numsit)</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keyword">WRITE</span>(6,4)<span class="stringliteral">&#39; SNRM    &#39;</span>,((snrm(i,j),i=1,3),j=1,numsit)</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="keyword">WRITE</span>(6,4)<span class="stringliteral">&#39; TCROT   &#39;</span>,(((tcrot(i,j,k),i=1,3),j=1,3),k=1,</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;     .numsit)</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    5 <span class="keyword">FORMAT</span>(/,a,/,3(3f20.4,/)/)</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; XLAT    &#39;</span>,(xlat(j),j=1,numsit)</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; XLON    &#39;</span>,(xlon(j),j=1,numsit)</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; GLAT    &#39;</span>,(glat(j),j=1,numsit)</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; SITHEIGHT &#39;</span>,(sitheight(j),j=1,numsit)</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      <span class="keyword">WRITE</span> ( 6, 9200 )  axoff, cfbase, cflat, cflon, cfsite,</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;     1           cfsitn, kaxis, oceamp, ocephs, sitlat, sitlon,</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;     2           sitrad, tctocf, zpath,  lnbase</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; 9200 <span class="keyword">FORMAT</span> (1x, <span class="stringliteral">&#39;AXOFF  = &#39;</span>, 2 ( d30.16, 10x ), /, 1x,</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;     .            <span class="stringliteral">&#39;CFBASE = &#39;</span>, 3 ( d30.16, 10x ), /, 1x,</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;     .            <span class="stringliteral">&#39;CFLAT  = &#39;</span>,/, 2 ( 3 ( d30.16, 10x ), /, 1x ),</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;     .            <span class="stringliteral">&#39;CFLON  = &#39;</span>,/, 2 ( 3 ( d30.16, 10x ), /, 1x ),</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;     .            <span class="stringliteral">&#39;CFSITE = &#39;</span>,/, 2 ( 3 ( d30.16, 10x ), /, 1x ),</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;     .            <span class="stringliteral">&#39;CFSITN = &#39;</span>,/, 2 ( 3 ( d30.16, 10x ), /, 1x ),</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;     .            <span class="stringliteral">&#39;KAXIS  = &#39;</span>,/, 2 ( i2, 10x ), /, 1x,</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;     .            <span class="stringliteral">&#39;OCEAMP = &#39;</span>,/,2( 3( 11f10.4,/ ),/),/,1x,</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;     .            <span class="stringliteral">&#39;OCEPHS = &#39;</span>,/,2( 3( 11f10.4,/ ),/,1x ),/,1x,</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;     .            <span class="stringliteral">&#39;SITLAT = &#39;</span>, 2 ( d30.16, 10x ), /, 1x,</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;     .            <span class="stringliteral">&#39;SITLON = &#39;</span>, 2 ( d30.16, 10x ), /, 1x,</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;     .            <span class="stringliteral">&#39;SITRAD = &#39;</span>, 2 ( d30.16, 10x ), /, 1x,</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;     .            <span class="stringliteral">&#39;TCTOCF = &#39;</span>,/,6( 3 ( d30.16, 10x ), /, 1x ),</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;     .            <span class="stringliteral">&#39;ZPATH  = &#39;</span>, 2 ( d30.16, 10x ), /, 1x,</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;     .            <span class="stringliteral">&#39;LNBASE = &#39;</span>, 4a2,1x,4a2)</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">C     Normal conclusiton.</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  600 <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">C     Abnormal conclusion.       .</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  700 <span class="keyword">WRITE</span> ( 6, 9300 )</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; 9300 <span class="keyword">FORMAT</span> (1x, <span class="stringliteral">&#39;CALC has been terminated in subroutine SITG.  &#39;</span>,</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;     1            <span class="stringliteral">&#39;The baseline identification was not successful.&#39;</span> )</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <span class="keyword">CALL </span><a class="code" href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a> (6hsitg  , 0, 0)</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">C******************************************************************************</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="csitm_8f.html#a00ed5e4e02b263376d7c95b892957e3c">sitp</a> ( R2000, STAR , EARTH, SITEV)</div><div class="line"><a name="l01014"></a><span class="lineno"><a class="line" href="csitm_8f.html#a00ed5e4e02b263376d7c95b892957e3c"> 1014</a></span>&#160;      <span class="keywordtype">IMPLICIT None</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">C 5.    SITP</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">C 5.1   SITP PROGRAM SPECIFICATION</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">C 5.1.1 SITP is the Site Module partial derivatives section. SITP</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">C       computes the partial derivatives of the delay and the rate with</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">C       respect to the site crust fixed vector components at each site.</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">C 5.1.2 RESTRICTIONS - NONE</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">C 5.1.3 REFERENCES - MARKHAM&#39;S X-DOCUMENT</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">C 5.2   SITP PROGRAM INTERFACE</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">C 5.2.1 CALLING SEQUENCE -</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">C         INPUT VARIABLES:</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">C           1.  R2000(3,3,3) - THE COMPLETE CRUST FIXED TO J2000.0 ROTATION </span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">C                              MATRIX AND ITS FIRST TWO CT TIME DERIVATIVES.</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">C                              (UNITLESS, 1/SEC, 1/SEC**2)</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">C           2.  STAR(3)      - THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">C           3.  EARTH(3,3)   - The position, velocity, and acceleration of the </span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">C                              Earth relative to the SSBC. (m, m/s, m/s**2)</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">C           4. SITEV(3,2)    - THE J2000.0 GEOCENTRIC VELOCITY VECTORS OF EACH</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">C                              OBSERVATION SITE. (M/SEC)</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">C         OUTPUT VARIABLES: NONE</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">C 5.2.2 COMMON BLOCKS USED -</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      include <span class="stringliteral">&#39;cphys.i&#39;</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">C          VARIABLES &#39;FROM&#39;:</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">C            1.  VLIGHT  -  THE VELOCITY OF LIGHT IN VACUUM. (M/SEC)</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">C            2.  VLIGHT2 -  THE VELOCITY OF LIGHT SQUARED.</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      include <span class="stringliteral">&#39;ccon.i&#39;</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">C          VARIABLES &#39;FROM&#39;:</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">C            1.  KSITC  -  THE SITE MODULE FLOW CONTROL FLAG.</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">C            2.  KSITD  -  THE SITE MODULE DEBUG OUTPUT FLAG.</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">C 5.2.3 PROGRAM SPECIFICATIONS -</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordtype">Real*8</span> R2000(3,3,3), STAR(3), EARTH(3,3), SITEV(3,2), DBDX1(3,2),</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;     *       dbdx2(3,2), dbdy1(3,2), dbdy2(3,2), dbdz1(3,2), </div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;     *       dbdz2(3,2), dsitp(3,2,2), vg(3), ve(3), c1, c2, tt, <a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="keywordtype">Integer*4</span> I, K</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">C 5.2.4 DATA BASE ACCESS -</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">C          &#39;GET&#39; VARIABLES: NONE</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">C          &#39;PUT&#39; VARIABLES:</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">C            1. DSITP(3,2,2) - THE PARTIAL DERIVATIVES OF THE DELAY AND THE</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">C                              DELAY RATE WITH RESPECT TO THE CRUST FIXED SITE</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">C                              COORDINATES AT EACH OBSERVATION SITE. THE FIRST</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">C                              INDEX RUNS OVER THE SITE COORDINATES, THE SECOND</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">C                              INDEX RUNS OVER THE SITES, AND THE THIRD RUNS</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">C                              OVER THE DELAY AND THE DELAY RATE. </span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">C                              (SEC/M, SEC/SEC-M)</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">C </span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">C          ACCESS CODES:</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">C            1. &#39;SIT PART&#39;  -  THE DATA BASE ACCESS CODE FOR THE SITE MODULE</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">C                              PARTIAL DERIVATIVES ARRAY.</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">C </span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">C 5.2.5 EXTERNAL INPUT/OUTPUT -  POSSIBLE DEBUG OUTPUT </span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">C </span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">C 5.2.6 SUBROUTINE INTERFACE -</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">C           CALLER SUBROUTINES: DRIVP </span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">C           CALLED SUBROUTINES: DOTP, PUT4</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">C </span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">C 5.2.7 CONSTANTS USED - VLIGHT </span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">C </span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">C 5.2.8 PROGRAM VARIABLES - </span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">C       1.  DBDX1(3,2)  -  THE PARTIAL DERIVATIVES OF THE J2000.0 BASELINE</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">C                          POSITION AND VELOCITY VECTORS WITH RESPECT TO THE</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">C                          X-COMPONENT OF THE CRUST FIXED SITE VECTOR AT</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">C                          OBSERVATION SITE #1. (M/M, M/M-SEC)</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">C       2.  DBDX2(3,2)  -  THE PARTIAL DERIVATIVES WITH RESPECT TO THE</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">C                          X-COMPONENT AT SITE #2.  (M/M, M/M-SEC)</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">C       3.  DBDY1(3,2)  -  THE PARTIAL DERIVATIVES WITH RESPECT TO THE</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">C                          Y-COMPONENT AT SITE #1.  (M/M, M/M-SEC)</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">C       4.  DBDY2(3,2)  -  THE PARTIAL DERIVATIVES WITH RESPECT TO THE</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">C                          Y-COMPONENT AT SITE #2.  (M/M, M/M-SEC)</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">C       5.  DBDZ1(3,2)  -  THE PARTIAL DERIVATIVES WITH RESPECT TO THE</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">C                          Z-COMPONENT AT SITE #1.  (M/M, M/M-SEC)</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">C       6.  DBDZ2(3,2)  -  THE PARTIAL DERIVATIVES WITH RESPECT TO THE</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">C                          Z-COMPONENT AT SITE #2.  (M/M, M/M-SEC)</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">C       7.  VE(3)       -  A local copy of the velocity of the Earth</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">C                          relative to the SSBC. </span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">C       9.  ci          -  1.d0/VLIGHT</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">C      10.  tt          -  A term common to all partials.</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">C 5.2.9 PROGRAMMER - DALE MARKHAM   01/13/77</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">C                    PETER DENATALE 07/13/77</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">C                    CHOPO MA       08/06/81</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">C                    89.07.20 Jim Ryan Documentation simplified.</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">C                    Jim Ryan 89:10:05 CPHYS common made an include file.</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">C                    Jim Ryan 89.12.12 UNIX-like database interface</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">C                                   implimented.</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">C                    Jim Ryan 91.11.22 Next term from the delay and rate</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">C                                   theoreticals added to partials computation.</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">C                    David Gordon 94.04.16 Converted to Implicit None.</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">C                    David Gordon 98.10.15 Added SITEV to input arguments. </span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">C                                   Changed site delay and rate partials </span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">C                                   computations to use the Consensus formula. </span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">C                                   Differences are very small and probably</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">C                                   not noticeable.</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">C     SITP program structure</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">C     Loop twice for delay and rate partials for both sites.</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">C      [Index K runs over the delays and rates.]</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordflow">DO</span> 300  k = 1,2</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">C   Loop three times for the calculation of the partials with respect to the</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">C    crust fixed vector components.</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="keywordflow">DO</span> 140  i = 1,3</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">C    Compute the partial derivatives of the J2000.0 baseline position and</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">C    velocity vectors with respect to the crust fixed vector coordinates </span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">C    at site #2.</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;          dbdx2(i,k) = r2000(i,1,k)</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;          dbdy2(i,k) = r2000(i,2,k)</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;          dbdz2(i,k) = r2000(i,3,k)</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">C    Compute the partial derivatives of the J2000.0 baseline position and</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">C    velocity vectors with respect to the crust fixed site coordinates </span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">C    at site #1.</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;          dbdx1(i,k) = - r2000(i,1,k)</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;          dbdy1(i,k) = - r2000(i,2,k)</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;          dbdz1(i,k) = - r2000(i,3,k)</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">C    Close the loop running over the vector components.</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  140   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">C    Complete the calculation of the partial derivatives of the delay and the</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">C    rate with respect to the crust fixed site vector components at each site.</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">c    First make a local copy of the velocity of the Earth.</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">C       DO I =1,3</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">C         VG(I) = EARTH(I,2)</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">C       Enddo</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">C       c1 = 1.d0/VLIGHT</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">C       c2 = 1.d0/VLIGHT2</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">C       tt = 1.d0 - c1*DOTP(star,vg)</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">C       DSITP(1,1,K)=-c1*DOTP(DBDX1(1,K),STAR)*tt-c2*DOTP(DBDX1(1,K),VG)</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">C       DSITP(2,1,K)=-c1*DOTP(DBDY1(1,K),STAR)*tt-c2*DOTP(DBDY1(1,K),VG)</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">C       DSITP(3,1,K)=-c1*DOTP(DBDZ1(1,K),STAR)*tt-c2*DOTP(DBDZ1(1,K),VG)</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">C       DSITP(1,2,K)=-c1*DOTP(DBDX2(1,K),STAR)*tt-c2*DOTP(DBDX2(1,K),VG)</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">C       DSITP(2,2,K)=-c1*DOTP(DBDY2(1,K),STAR)*tt-c2*DOTP(DBDY2(1,K),VG)</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">C       DSITP(3,2,K)=-c1*DOTP(DBDZ2(1,K),STAR)*tt-c2*DOTP(DBDZ2(1,K),VG)</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">C     WRITE(6,8)&#39; Old DSITP &#39;, DSITP(1,1,K), DSITP(2,1,K),DSITP(3,1,K)</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">C     WRITE(6,8)&#39; Old DSITP &#39;, DSITP(1,2,K), DSITP(2,2,K),DSITP(3,2,K)</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">C Change to use the Consensus model definition</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        <span class="keywordflow">DO</span> i =1,3</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;          vg(i) = earth(i,2) + sitev(i,2)</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          ve(i) = earth(i,2)</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="keywordflow">        Enddo</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;         tt = 1.d0 + <a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(star,vg)/vlight</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        dsitp(1,1,k) = -<a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdx1(1,k),star)/vlight/tt</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;     *                 - <a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdx1(1,k),ve)/vlight2</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        dsitp(2,1,k) = -<a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdy1(1,k),star)/vlight/tt</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;     *                 - <a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdy1(1,k),ve)/vlight2</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        dsitp(3,1,k) = -<a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdz1(1,k),star)/vlight/tt</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;     *                 - <a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdz1(1,k),ve)/vlight2</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        dsitp(1,2,k) = -<a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdx2(1,k),star)/vlight/tt</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;     *                 - <a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdx2(1,k),ve)/vlight2</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        dsitp(2,2,k) = -<a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdy2(1,k),star)/vlight/tt</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;     *                 - <a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdy2(1,k),ve)/vlight2</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        dsitp(3,2,k) = -<a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdz2(1,k),star)/vlight/tt</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;     *                 - <a class="code" href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a>(dbdz2(1,k),ve)/vlight2</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">c     WRITE(6,8)&#39; New DSITP1 &#39;, DSITP(1,1,K), DSITP(2,1,K),DSITP(3,1,K)</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">c     WRITE(6,8)&#39; New DSITP2 &#39;, DSITP(1,2,K), DSITP(2,2,K),DSITP(3,2,K)</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">C    Close the loop which runs over the partials of the delay and rate.</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  300 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">C    PUT the site module partials.</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#ae24d34be5944d9b663113269d70f25c5">put4</a> (<span class="stringliteral">&#39;SIT PART      &#39;</span>,dsitp, 3, 2, 2 )</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">C    Check KSITD for debug output.</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <span class="keywordflow">IF</span> ( ksitd .EQ. 0 )  <span class="keywordflow">GO TO</span> 700</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keyword">WRITE</span> ( 6, 9)</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    9 <span class="keyword">FORMAT</span> (1x, <span class="stringliteral">&#39;Debug output for subroutine SITP.&#39;</span> )</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    8 <span class="keyword">FORMAT</span>(a,4d25.16/(7x,5d25.16))</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; DBDX1   &#39;</span>,dbdx1</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; DBDX2   &#39;</span>,dbdx2</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; DBDY1   &#39;</span>,dbdy1</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; DBDY2   &#39;</span>,dbdy2</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; DBDZ1   &#39;</span>,dbdz1</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; DBDZ2   &#39;</span>,dbdz2</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; DSITP   &#39;</span>,dsitp</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; VLIGHT  &#39;</span>,vlight</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; c1      &#39;</span>,c1</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; c2      &#39;</span>,c2</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; tt      &#39;</span>,tt</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="keyword">WRITE</span>(6,8)<span class="stringliteral">&#39; vg      &#39;</span>,vg</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <span class="keyword">WRITE</span> ( 6, 9200 )  r2000, star</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; 9200 <span class="keyword">FORMAT</span> (1x, <span class="stringliteral">&#39;R2000 = &#39;</span>, 9 ( 3 ( d30.16, 10x ), /, 1x ),</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;     1            <span class="stringliteral">&#39;STAR  = &#39;</span>,     3 ( d30.16, 10x ) )</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">C     Normal conclusion.</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  700 <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">C*******************************************************************</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="csitm_8f.html#afcf454f0870373286c49c69ffb2375c0">bkplh</a>(XYZ,PLH,PI,A,FL)                                 </div><div class="line"><a name="l01226"></a><span class="lineno"><a class="line" href="csitm_8f.html#afcf454f0870373286c49c69ffb2375c0"> 1226</a></span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">C NAME             bkplh.f                                    </span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">C VERSION          93.01.27                                             </span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">C WRITTEN          B. Archinal, USNO, July 20-23, 1990.</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">C                  Name changed from &quot;borkow&quot; to &quot;bkplh&quot;, and arguments</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">C                  adapted for efficient use by Calc (csitm), Dbcal,</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">C                  and Solve.  BA, 93.01.27.                 </span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment">C PURPOSE          Converts XYZ coordinates to Phi, Lambda, H           </span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment">C                  ellipsoidal coordinates.                             </span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">C References       Borkowski, K. M. (1989).  &quot;Accurate Algorithms to    </span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">C                  transform geocentric to geodetic coordinates&quot;        </span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">C                  *Bulletin Geodesique*, v. 63, pp. 50-56.  Also see   </span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">C                  Borkowski, K. M. (1987).  &quot;Transformation of         </span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">C                  Geocentric to Geodetic Coordinates without           </span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">C                  Approximations&quot;, *Astrophysics and Space Science*,   </span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">C                  v. 139, n. 1, pp. 1-4.  Correction in (1988), v. 146,</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">C                  n. 1, p. 201.                                        </span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">C Note             Will not work for points on the Z axis, i.e. if      </span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">C                  if X=Y=0 (Phi = +/- 90 degrees).                     </span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">C Calling sequence CALL bkplh ( XYZ, PLH, PI, A, FL )                    </span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">C ARGUMENT LIST                                                         </span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">C  PARM       TYPE DESCRIPTION                                          </span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">C  XYZ(3)     D    INPUT - XYZ Cartesian coordinates of point.          </span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment">C                  XYZ(1) and XYZ(2) must not both be zero.  Units are  </span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">C                  those of A below.                                    </span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">C  PLH(3)     D    OUTPUT - Ellipsoidal coordinates of point, in        </span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">C                  geodetic latitude, longitude, and height.  Units     </span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">C                  for latitude and longitude are in radians, units     </span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">C                  of height are those of A below.</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">C  PI         D    INPUT - Ratio of circumference to diameter of circle.</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">C                  Unitless.</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">C  A          D    INPUT - Semi-major axis of ellipsoid.  Units are     </span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">C                  of distance (meters, kilometers, miles, etc.).       </span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">C  FL         D    INPUT - Flattening of ellipsoid.  Unitless.</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">C                 </span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">C SUBPROGRAMS USED                                                      </span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">C  Fortran         DABS      DACOS     DATAN     DATAN2   DCOS          </span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">C                  DSIN      DSQRT                                      </span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">C COMMON BLOCKS    None.                                                </span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">C INPUT            None.                                                </span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">C OUTPUT           None, unless diagnostic printout uncommented.                                                </span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">C LANGUAGE         Fortran 77.                </span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">C===================================================================    </span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="keywordtype">Real*8</span> A,B,D,DABS,DACOS,DATAN,DATAN2,DCOS,DSIN,</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;     .       dsqrt,e,f,fl,g,p,pi,q,r,t,v,x,y,z,zlong</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="keywordtype">Real*8</span> XYZ(3),PLH(3)                                           </div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">C     INTEGER IOUT</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">C--- XYZ.                                                               </span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      x=xyz(1)                                                          </div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      y=xyz(2)                                                          </div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      z=xyz(3)                                                          </div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">C--- Semi-minor axis.                                                   </span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      b=a*(1.d0-fl)                                                     </div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">C--- Set sign of B to that of Z in order to get sign of Phi correct.    </span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <span class="keywordflow">IF</span>(z.LT.0.d0) b=-b                                                </div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">C--- Intermediate Values for Latitude.                                  </span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      r=dsqrt(x*x+y*y)                                                  </div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      e=(b*z-(a*a-b*b))/(a*r)                                           </div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      f=(b*z+(a*a-b*b))/(a*r)                                           </div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      p=4.d0/3.d0 * (e*f+1)                                             </div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      q=2.d0 * (e*e - f*f)                                              </div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      d=p*p*p+q*q                                                       </div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="keywordflow">IF</span>(d.GE.0.d0) <span class="keywordflow">then</span>                                                <span class="comment">     </span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">        v=(dsqrt(d)-q)**(1.d0/3.d0) - (dsqrt(d)+q)**(1.d0/3.d0)           </span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">        </span><span class="keywordflow">else</span>                                                     </div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        v=2.d0 * dsqrt(-p) * dcos(1.d0/3.d0 *                          <span class="comment">  </span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">     .  dacos(q/(p * dsqrt(-p))))</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment"></span><span class="keywordflow">        endif</span>                                 </div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">C   (Improve V - not really necessary except near axes.)                </span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <span class="keywordflow">IF</span>(v*v.LT.dabs(p)) v=-(v*v*v + 2.d0*q)/(3.d0*p)                   </div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      g=(dsqrt(e*e+v)+e)/2.d0                                           </div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      t=dsqrt( g*g  + (f-v*g)/(2.d0*g-e) ) - g                          </div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      plh(1)=datan( (a*(1.d0-t*t))/(2.d0*b*t) )                         </div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment">C--- HEIGHT.                                                            </span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      plh(3)=(r-a*t)*dcos(plh(1)) + (z-b)*dsin(plh(1))                  </div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">C--- LONGITUDE.                                                         </span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      zlong=datan2(y,x)                                                 </div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="keywordflow">IF</span>(zlong.LT.0.d0) zlong=zlong+2.d0*pi                             </div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      plh(2)=zlong                                                      </div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">C   Diagnostic output.                                                  </span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">C                                                                       </span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment">C     IOUT=11                                                           </span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment">C     WRITE(IOUT,901) A,F,B                                          </span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="comment">C 901 FORMAT(&#39; A,F,B:&#39;,3D25.16)                                       </span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment">C     WRITE(IOUT,902) X, Y, Z                                           </span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">C 902 FORMAT(&#39; X, Y, Z:&#39;,3D25.16)                                       </span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment">C     WRITE(IOUT,903) R,E,F                                             </span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">C 903 FORMAT(&#39; R, E, F:&#39;,3D25.16)                                       </span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">C     WRITE(IOUT,904) P,Q,D                                             </span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">C 904 FORMAT(&#39; P, Q, D:&#39;,3D25.16)                                       </span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment">C     WRITE(IOUT,905) V,G,T                                             </span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">C 905 FORMAT(&#39; V, G, T:&#39;,3D25.16)                                       </span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">C--- Check.                                                             </span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">C     CHK1=T*T*T*T + 2.D0 * E *T*T*T + 2.D0 * F *T - 1.D0               </span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">C     CHK2=V*V*V + 3.D0*P*V + 2.D0*Q                                    </span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment">C     WRITE(IOUT,906) CHK1,CHK2                                         </span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment">C 906 FORMAT(&#39;Check values (=0):&#39;,2D25.16)                              </span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keywordflow">RETURN</span>                                                            </div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="keyword">      END                                                               </span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">C******************************************************************************</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="keyword">       SUBROUTINE </span><a class="code" href="csitm_8f.html#ae97b72650e85eae768f87ff9ba943531">sitblk</a>(Kerr)</div><div class="line"><a name="l01347"></a><span class="lineno"><a class="line" href="csitm_8f.html#ae97b72650e85eae768f87ff9ba943531"> 1347</a></span>&#160;       <span class="keywordtype">Implicit None</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      include <span class="stringliteral">&#39;cmxst.i&#39;</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      include <span class="stringliteral">&#39;inputs.i&#39;</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <span class="keywordtype">Integer*2</span> Getunit, Kerr(10)</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="keywordtype">Integer*4</span> I, II, Jsite(max_stat), Iunit, An_typ, ios,</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;     *          iquit, index</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keywordtype">Real*8</span> Sit_X, Sit_Y, Sit_Z, Ax_off, S_zen</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="keywordtype">Character*80</span> Inbuf</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keywordtype">Character*8</span>  Dbsites(max_stat)</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      equivalence(lnsite(1,1), dbsites(1))</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">C   Initialize station counter</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;       <span class="keywordflow">Do</span> i = 1, max_stat</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;         jsite(i) = 0</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="keywordflow">       Enddo</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">C  Open the input sites data file</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment">c       Iunit = getunit()</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">c       Open (Unit=Iunit, File=Ex_sites, Status=&#39;old&#39;, Readonly,</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment">c     *       Err=240, Iostat=ios)</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="keywordflow">If</span> ( index(ex_sites,<span class="stringliteral">&#39;blokq&#39;</span>) .gt. 0) <span class="keywordflow">Then</span> </div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">C  If it is a blokq.dat file, find the site catalog section</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  50   <span class="keywordflow">Continue</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;       <span class="keyword">Read</span>(iunit,<span class="stringliteral">&#39;(A80)&#39;</span>) inbuf</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">C      If (Inbuf(1:18) .eq. &#39;$$ STATION CATALOG&#39;) Go to 100</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;       <span class="keywordflow">If</span> (inbuf(1:4) .eq. <span class="stringliteral">&#39;$$//&#39;</span>) <span class="keywordflow">Go to</span> 100</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;       <span class="keywordflow">Go to</span> 50</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; 100   <span class="keywordflow">Continue</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="keywordflow">      Endif</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; 110   <span class="keywordflow">Continue</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;       <span class="keyword">Read</span>(iunit,<span class="stringliteral">&#39;(A80)&#39;</span>,end=200) inbuf</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">C   Skip comments and illegal lines</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">c      If (Inbuf(1:2) .eq. &#39;$$&#39;  ) Go to 110</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;       <span class="keywordflow">If</span> (inbuf(1:4) .ne. <span class="stringliteral">&#39;    &#39;</span>) <span class="keywordflow">Go to</span> 110</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;       <span class="keywordflow">If</span> (inbuf(13:13) .ne. <span class="stringliteral">&#39; &#39;</span> ) <span class="keywordflow">Go to</span> 110</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">C   Finished site catalog</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;       <span class="keywordflow">If</span> (inbuf(1:2) .eq. <span class="stringliteral">&#39;//&#39;</span>) <span class="keywordflow">Go to</span> 200</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;       <span class="keywordflow">Do</span> i = 1, numsit</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;         <span class="keywordflow">If</span> (inbuf(5:12) .eq. dbsites(i)) <span class="keywordflow">Then</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">C         print *, &#39;Site matched: &#39;, Dbsites(I)</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">C  Matched I&#39;th station in data base station list, save station particulars</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;           ii = i</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;           <span class="keyword">Read</span>(inbuf(14:76),*) sit_x, sit_y, sit_z, an_typ, ax_off, </div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;     *                          s_zen</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;           sitxyz(1,ii) = sit_x</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;           sitxyz(2,ii) = sit_y</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;           sitxyz(3,ii) = sit_z</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;           sitaxo(ii)   = ax_off</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;           ktype(ii)    = an_typ</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;           sitzen(ii)   = s_zen</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;           jsite(ii)    = ii</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="keywordflow">         Endif</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="keywordflow">       Enddo</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;       <span class="keywordflow">Go to</span> 110</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; 200   <span class="keywordflow">Continue</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;       <span class="keyword">Close</span>(iunit)</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">C   Verify that we have site a priori&#39;s for all stations. If not, we must</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">C    quit here and tell the user to fix the problem.</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        iquit = 0</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      <span class="keywordflow">DO</span> i = 1, numsit</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keywordflow">If</span> (jsite(i) .eq. 0) <span class="keywordflow">Then</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;          <span class="keyword">Write</span>(6,<span class="stringliteral">&#39;(&quot; SITBLK: No match for station #&quot;,i3)&#39;</span>) i</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;          iquit = iquit + 1</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="keywordflow">        Endif</span> </div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="keywordflow">      ENDDO</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;       <span class="keywordflow">If</span> (iquit.eq.0) <span class="keywordflow">Then</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        kerr(3) = 0</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        kerr(4) = 0</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        kerr(5) = 0</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        kerr(6) = 0</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;       <span class="keywordflow">Else</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keyword">Call </span><a class="code" href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a>(6hsitblk,0,0)</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="keywordflow">       Endif</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">C       print *, &#39; SITXYZ &#39;, SITXYZ</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">C       print *, &#39; SITAXO &#39;, SITAXO</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">C       print *, &#39; KTYPE  &#39;, KTYPE </span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">C       print *, &#39; SITZEN &#39;, SITZEN</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">C  Now we must replace the site a priori&#39;s in the data base</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#aaec75c0e539fcc5c41612a47078fbb5c">putr</a>(<span class="stringliteral">&#39;SITERECS      &#39;</span>, sitxyz, 3, numsit, 1)</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#aaec75c0e539fcc5c41612a47078fbb5c">putr</a>(<span class="stringliteral">&#39;SITEZENS      &#39;</span>, sitzen, numsit, 1, 1)</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#af642734b207cfc92a030baecf317b152">puti</a>(<span class="stringliteral">&#39;AXISTYPS      &#39;</span>, ktype , numsit, 1, 1)</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#aaec75c0e539fcc5c41612a47078fbb5c">putr</a>(<span class="stringliteral">&#39;AXISOFFS      &#39;</span>, sitaxo, numsit, 1, 1)</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;       <span class="keywordflow">Go to</span> 270</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment">C   error on OPEN</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; 240  <span class="keywordflow">Continue</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      print *, <span class="stringliteral">&#39;Error on OPEN of blokq file &#39;</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; 270  <span class="keywordflow">Continue</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="keywordflow">Return</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="keyword">      End</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment">C******************************************************************************</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="keyword">       SUBROUTINE </span><a class="code" href="csitm_8f.html#a640a106fb8f7ce53f206e6381b7fd067">ocnin</a>(Kerr)</div><div class="line"><a name="l01461"></a><span class="lineno"><a class="line" href="csitm_8f.html#a640a106fb8f7ce53f206e6381b7fd067"> 1461</a></span>&#160;       <span class="keywordtype">Implicit None</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      include <span class="stringliteral">&#39;cmxst.i&#39;</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      include <span class="stringliteral">&#39;inputs.i&#39;</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      <span class="keywordtype">Real*8</span>           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <span class="keyword">COMMON</span> / cmath / pi, twopi, halfpi, convd, convds, convhs, secday</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="keywordtype">EXTERNAL</span> cmathb</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">C         VARIABLES &#39;FROM&#39;:</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">C            1. CONVD - THE CONVERSION FACTOR FROM DEGREES TO RADIANS (RAD/DEG)</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <span class="keywordtype">Integer*2</span> Getunit, Kerr(10)</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      <span class="keywordtype">Integer*4</span> I, II, Jsite(max_stat), Iunit, ios, Iquit, Index, K</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="keywordtype">Real*8</span>    OC11(11) </div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      <span class="keywordtype">Character*80</span> Inbuf</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      <span class="keywordtype">Character*8</span>  Dbsites(max_stat)</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      equivalence(lnsite(1,1), dbsites(1))</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">C   Initialize station counter</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;       <span class="keywordflow">Do</span> i = 1, max_stat</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;         jsite(i) = 0</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="keywordflow">       Enddo</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">C  Open the Ocean loading data file</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">c       Iunit = getunit()</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment">c       Open (Unit=Iunit, File=Ex_sites, Status=&#39;old&#39;, Readonly,</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">c     *       Err=240, Iostat=ios)</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      <span class="keywordflow">If</span> ( index(ex_sites,<span class="stringliteral">&#39;blokq&#39;</span>) .gt. 0) <span class="keywordflow">Then</span> </div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">C  Blokq.dat file, find the site catalog</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  50   <span class="keywordflow">Continue</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;       <span class="keyword">Read</span>(iunit,<span class="stringliteral">&#39;(A80)&#39;</span>) inbuf</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;       <span class="keywordflow">If</span> (inbuf(1:2) .eq. <span class="stringliteral">&#39;//&#39;</span>) <span class="keywordflow">Go to</span> 100</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;       <span class="keywordflow">Go to</span> 50</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; 100   <span class="keywordflow">Continue</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="keywordflow">      Endif</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; 110   <span class="keywordflow">Continue</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;       <span class="keyword">Read</span>(iunit,<span class="stringliteral">&#39;(A80)&#39;</span>,end=200) inbuf</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment">C   Skip comments and illegal lines</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;       <span class="keywordflow">If</span> (inbuf(1:2) .eq. <span class="stringliteral">&#39;$$&#39;</span>) <span class="keywordflow">Go to</span> 110</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;       <span class="keywordflow">If</span> (inbuf(1:2) .ne. <span class="stringliteral">&#39;  &#39;</span>) <span class="keywordflow">Go to</span> 110</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">c      If (Inbuf(11:11) .ne. &#39; &#39; ) Go to 110</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">C   Finished site catalog</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;       <span class="keywordflow">If</span> (inbuf(1:2) .eq. <span class="stringliteral">&#39;//&#39;</span>) <span class="keywordflow">Go to</span> 200</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">C See if this station is in the database list</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;       <span class="keywordflow">Do</span> i = 1, numsit</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;         <span class="keywordflow">If</span> (inbuf(3:10) .eq. dbsites(i)) <span class="keywordflow">Then</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">C         print *, &#39;Site matched: &#39;, Dbsites(I)</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">C  Matched I&#39;th station in data base station list, save station particulars</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;           ii = i</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">C  Skip comments</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; 170    <span class="keywordflow">Continue</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="keyword">Read</span>(iunit,<span class="stringliteral">&#39;(A80)&#39;</span>,end=200) inbuf</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="keywordflow">If</span> (inbuf(1:2) .eq. <span class="stringliteral">&#39;$$&#39;</span>) <span class="keywordflow">Go to</span> 170</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">C   Read 6 data lines</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        <span class="keyword">Read</span>(inbuf,*,err=180) oc11 </div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;          <span class="keywordflow">Do</span> k=1,11</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;           sitoam(k,ii) = oc11(k)</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="keyword">Read</span>(iunit,*,err=180) oc11 </div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;          <span class="keywordflow">Do</span> k=1,11</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;           sithoa(k,1,ii) = oc11(k)</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="keyword">Read</span>(iunit,*,err=180) oc11 </div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;          <span class="keywordflow">Do</span> k=1,11</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;           sithoa(k,2,ii) = oc11(k)</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <span class="keyword">Read</span>(iunit,*,err=180) oc11 </div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;          <span class="keywordflow">Do</span> k=1,11</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;           sitoph(k,ii) = oc11(k) * convd</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <span class="keyword">Read</span>(iunit,*,err=180) oc11 </div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;          <span class="keywordflow">Do</span> k=1,11</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;           sithop(k,1,ii) = oc11(k) * convd</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        <span class="keyword">Read</span>(iunit,*,err=180) oc11 </div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;          <span class="keywordflow">Do</span> k=1,11</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;           sithop(k,2,ii) = oc11(k) * convd</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;           jsite(ii)    = ii</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="keywordflow">         Endif</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="keywordflow">       Enddo</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;       <span class="keywordflow">Go to</span> 110</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; 200   <span class="keywordflow">Continue</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;       <span class="keyword">Close</span>(iunit)</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">C   Verify that we have ocean loading a priori&#39;s for all stations, except any</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">C    site at the geocenter. If not, we must quit here and tell the user to fix </span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">C    the problem.</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        iquit = 0</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      <span class="keywordflow">DO</span> i = 1, numsit</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keywordflow">If</span> (jsite(i) .eq. 0) <span class="keywordflow">Then</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;           <span class="keywordflow">If</span> (i .ne. zero_site) <span class="keywordflow">Then</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;            <span class="keyword">Write</span>(6,<span class="stringliteral">&#39;(&quot; SITBLK: No match for station #&quot;,i3)&#39;</span>) i</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            iquit = iquit + 1</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="keywordflow">           Endif</span> </div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="keywordflow">        Endif</span> </div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="keywordflow">      ENDDO</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;       <span class="keywordflow">If</span> (iquit.eq.0) <span class="keywordflow">Then</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        kerr(7)  = 0</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        kerr(8)  = 0</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        kerr(9)  = 0</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        kerr(10) = 0</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;       <span class="keywordflow">Else</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="keyword">Call </span><a class="code" href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a>(6hocnin ,0,0)</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="keywordflow">       Endif</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">C       print *, &#39; SITOAM &#39;, SITOAM</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">C       print *, &#39; SITOPH &#39;, SITOPH</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">C       print *, &#39; SITHOA &#39;, SITHOA</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">C       print *, &#39; SITHOP &#39;, SITHOP</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">C  Now we must replace the ocean loading a priori&#39;s in the data base</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#aaec75c0e539fcc5c41612a47078fbb5c">putr</a>(<span class="stringliteral">&#39;SITOCAMP      &#39;</span>, sitoam, 11, numsit, 1 )</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#aaec75c0e539fcc5c41612a47078fbb5c">putr</a>(<span class="stringliteral">&#39;SITOCPHS      &#39;</span>, sitoph, 11, numsit, 1 )</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#aaec75c0e539fcc5c41612a47078fbb5c">putr</a>(<span class="stringliteral">&#39;SITHOCAM      &#39;</span>, sithoa, 11, 2, numsit )</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interface_8f.html#aaec75c0e539fcc5c41612a47078fbb5c">putr</a>(<span class="stringliteral">&#39;SITHOCPH      &#39;</span>, sithop, 11, 2, numsit )</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;       <span class="keywordflow">Go to</span> 270</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">C   error on Read</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; 180  <span class="keywordflow">Continue</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      print *, <span class="stringliteral">&#39;OCNIN: Error on read of ocean loading file &#39;</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        <span class="keyword">Call </span><a class="code" href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a>(6hocnin ,0,0)</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment">C   error on OPEN</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160; 240  <span class="keywordflow">Continue</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      print *, <span class="stringliteral">&#39;OCNIN: Error on OPEN of ocean loading file &#39;</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="keyword">Call </span><a class="code" href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a>(6hocnin ,0,0)</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160; 270  <span class="keywordflow">Continue</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      <span class="keywordflow">Return</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="keyword">      End</span></div><div class="ttc" id="interface_8f_html_af642734b207cfc92a030baecf317b152"><div class="ttname"><a href="interface_8f.html#af642734b207cfc92a030baecf317b152">puti</a></div><div class="ttdeci">subroutine puti(STR1, STR2, NCHR2, N1, N2)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8f_source.html#l01135">interface.f:1135</a></div></div>
<div class="ttc" id="csitm_8f_html_aa9d490db42c8398a747838ceed61e6d4"><div class="ttname"><a href="csitm_8f.html#aa9d490db42c8398a747838ceed61e6d4">siti</a></div><div class="ttdeci">subroutine siti</div><div class="ttdef"><b>Definition:</b> <a href="csitm_8f_source.html#l00118">csitm.f:118</a></div></div>
<div class="ttc" id="cmatu_8f_html_a244b79ca75dda565e26ccbc7e6a27059"><div class="ttname"><a href="cmatu_8f.html#a244b79ca75dda565e26ccbc7e6a27059">rotat</a></div><div class="ttdeci">subroutine rotat(THETA, I, R)</div><div class="ttdef"><b>Definition:</b> <a href="cmatu_8f_source.html#l00002">cmatu.f:2</a></div></div>
<div class="ttc" id="cmatu_8f_html_a0c394eb642450bfe952b048edac108f8"><div class="ttname"><a href="cmatu_8f.html#a0c394eb642450bfe952b048edac108f8">mmul2</a></div><div class="ttdeci">subroutine mmul2(A, B, C)</div><div class="ttdef"><b>Definition:</b> <a href="cmatu_8f_source.html#l00607">cmatu.f:607</a></div></div>
<div class="ttc" id="interface_8f_html_ac8790f309ea371d3baf8c028d6b49e5b"><div class="ttname"><a href="interface_8f.html#ac8790f309ea371d3baf8c028d6b49e5b">get4</a></div><div class="ttdeci">subroutine get4(VARNAM, RVARB, NDIM1, NDIM2, NDIM3, NDO, IERR)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8f_source.html#l00002">interface.f:2</a></div></div>
<div class="ttc" id="interface_8f_html_a06e06b83a933855a258c22bdff0d38dc"><div class="ttname"><a href="interface_8f.html#a06e06b83a933855a258c22bdff0d38dc">adda</a></div><div class="ttdeci">subroutine adda(N1, STR1, STR2, NSTR2, N2, N3)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8f_source.html#l01149">interface.f:1149</a></div></div>
<div class="ttc" id="interface_8f_html_a5696959340499139130b420c4ac78373"><div class="ttname"><a href="interface_8f.html#a5696959340499139130b420c4ac78373">addr</a></div><div class="ttdeci">subroutine addr(N1, STR1, STR2, NSTR2, N2, N3)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8f_source.html#l01157">interface.f:1157</a></div></div>
<div class="ttc" id="interface_8f_html_ae24d34be5944d9b663113269d70f25c5"><div class="ttname"><a href="interface_8f.html#ae24d34be5944d9b663113269d70f25c5">put4</a></div><div class="ttdeci">subroutine put4(STR1, STR2, NCHR2, N1, N2)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8f_source.html#l00839">interface.f:839</a></div></div>
<div class="ttc" id="cvecu_8f_html_ad6a81c2e4afb6da85999b1e5bbcc42ce"><div class="ttname"><a href="cvecu_8f.html#ad6a81c2e4afb6da85999b1e5bbcc42ce">dotp</a></div><div class="ttdeci">real *8 function dotp(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="cvecu_8f_source.html#l00165">cvecu.f:165</a></div></div>
<div class="ttc" id="csitm_8f_html_a640a106fb8f7ce53f206e6381b7fd067"><div class="ttname"><a href="csitm_8f.html#a640a106fb8f7ce53f206e6381b7fd067">ocnin</a></div><div class="ttdeci">subroutine ocnin(Kerr)</div><div class="ttdef"><b>Definition:</b> <a href="csitm_8f_source.html#l01461">csitm.f:1461</a></div></div>
<div class="ttc" id="csitm_8f_html_ae33d05b01559c9c88ffe00c97a87d9e0"><div class="ttname"><a href="csitm_8f.html#ae33d05b01559c9c88ffe00c97a87d9e0">sitg</a></div><div class="ttdeci">subroutine sitg(AXOFF, CFBASE, CFLAT, CFLON, CFSITE, CFSITN, KAXIS, OCEAMP, OCEPHS, SITLAT, SITLON, SITRAD, TCTOCF, RTTOCF, ZPATH, SITHEIGHT, GEOLAT)</div><div class="ttdef"><b>Definition:</b> <a href="csitm_8f_source.html#l00714">csitm.f:714</a></div></div>
<div class="ttc" id="csitm_8f_html_afcf454f0870373286c49c69ffb2375c0"><div class="ttname"><a href="csitm_8f.html#afcf454f0870373286c49c69ffb2375c0">bkplh</a></div><div class="ttdeci">subroutine bkplh(XYZ, PLH, PI, A, FL)</div><div class="ttdef"><b>Definition:</b> <a href="csitm_8f_source.html#l01226">csitm.f:1226</a></div></div>
<div class="ttc" id="csitm_8f_html_ae97b72650e85eae768f87ff9ba943531"><div class="ttname"><a href="csitm_8f.html#ae97b72650e85eae768f87ff9ba943531">sitblk</a></div><div class="ttdeci">subroutine sitblk(Kerr)</div><div class="ttdef"><b>Definition:</b> <a href="csitm_8f_source.html#l01347">csitm.f:1347</a></div></div>
<div class="ttc" id="csitm_8f_html_a00ed5e4e02b263376d7c95b892957e3c"><div class="ttname"><a href="csitm_8f.html#a00ed5e4e02b263376d7c95b892957e3c">sitp</a></div><div class="ttdeci">subroutine sitp(R2000, STAR, EARTH, SITEV)</div><div class="ttdef"><b>Definition:</b> <a href="csitm_8f_source.html#l01014">csitm.f:1014</a></div></div>
<div class="ttc" id="interface_8f_html_ae6231d12a4386a2dd80ae35f21fdde1a"><div class="ttname"><a href="interface_8f.html#ae6231d12a4386a2dd80ae35f21fdde1a">addi</a></div><div class="ttdeci">subroutine addi(N1, STR1, STR2, NSTR2, N2, N3)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8f_source.html#l01170">interface.f:1170</a></div></div>
<div class="ttc" id="cvecu_8f_html_a6a89e2feb2a4f077a63790728a419430"><div class="ttname"><a href="cvecu_8f.html#a6a89e2feb2a4f077a63790728a419430">vecsb</a></div><div class="ttdeci">subroutine vecsb(A, B, C)</div><div class="ttdef"><b>Definition:</b> <a href="cvecu_8f_source.html#l00084">cvecu.f:84</a></div></div>
<div class="ttc" id="interface_8f_html_a4c20993a508f8cf61100bdcc9883ee15"><div class="ttname"><a href="interface_8f.html#a4c20993a508f8cf61100bdcc9883ee15">puta</a></div><div class="ttdeci">subroutine puta(STR1, STR2, NCHR2, N1, N2)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8f_source.html#l01120">interface.f:1120</a></div></div>
<div class="ttc" id="ckill_8f_html_afa254e765dcc710876177c91bc0252ef"><div class="ttname"><a href="ckill_8f.html#afa254e765dcc710876177c91bc0252ef">ckill</a></div><div class="ttdeci">subroutine ckill(LNAME, I1, I2)</div><div class="ttdef"><b>Definition:</b> <a href="ckill_8f_source.html#l00002">ckill.f:2</a></div></div>
<div class="ttc" id="interface_8f_html_a3ae66a60ec1589dc5a59d4e0504b3b0c"><div class="ttname"><a href="interface_8f.html#a3ae66a60ec1589dc5a59d4e0504b3b0c">geti</a></div><div class="ttdeci">subroutine geti(VARNAM, IVARB, NDIM1, NDIM2, NDIM3, NDO, IERR)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8f_source.html#l00635">interface.f:635</a></div></div>
<div class="ttc" id="interface_8f_html_aaec75c0e539fcc5c41612a47078fbb5c"><div class="ttname"><a href="interface_8f.html#aaec75c0e539fcc5c41612a47078fbb5c">putr</a></div><div class="ttdeci">subroutine putr(STR1, STR2, NCHR2, N1, N2)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8f_source.html#l01101">interface.f:1101</a></div></div>
<div class="ttc" id="csitm_8f_html_a9601fba281579c0631d439803ca96317"><div class="ttname"><a href="csitm_8f.html#a9601fba281579c0631d439803ca96317">sita</a></div><div class="ttdeci">subroutine sita</div><div class="ttdef"><b>Definition:</b> <a href="csitm_8f_source.html#l00002">csitm.f:2</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
